{"ast":null,"code":"import { OxdSheet, OxdSpinner, OxdTreeView, DEVICE_TYPES, useResponsive, OxdSwitchInput, OxdDropdownMenu } from '@ohrm/oxd';\nimport { computed } from 'vue';\nimport SaveOrgUnit from './SaveOrgUnit';\nimport EditOrgUnit from './EditOrgUnit';\nimport { APIService } from '@/core/util/services/api.service';\nimport DeleteConfirmationDialog from '@ohrm/components/dialogs/DeleteConfirmationDialog';\nexport default {\n  components: {\n    'oxd-sheet': OxdSheet,\n    'save-org-unit': SaveOrgUnit,\n    'edit-org-unit': EditOrgUnit,\n    'oxd-tree-view': OxdTreeView,\n    'oxd-dropdown': OxdDropdownMenu,\n    'oxd-loading-spinner': OxdSpinner,\n    'oxd-switch-input': OxdSwitchInput,\n    'delete-confirmation': DeleteConfirmationDialog\n  },\n  setup() {\n    const http = new APIService(window.appGlobal.baseUrl, '/api/v2/admin/subunits');\n    const responsiveState = useResponsive();\n    const isMobile = computed(() => {\n      return !(responsiveState.screenType === DEVICE_TYPES.DEVICE_LG || responsiveState.screenType === DEVICE_TYPES.DEVICE_XL);\n    });\n    return {\n      http,\n      isMobile\n    };\n  },\n  data() {\n    return {\n      isLoading: false,\n      editable: false,\n      showSaveModal: false,\n      saveModalState: null,\n      showEditModal: false,\n      editModalState: null,\n      data: {}\n    };\n  },\n  created() {\n    this.fetchOrgStructure();\n  },\n  methods: {\n    onDelete(node) {\n      this.$refs.deleteDialog.showDialog().then(confirmation => {\n        if (confirmation === 'ok') {\n          this.isLoading = true;\n          this.http.delete(node.id).then(() => {\n            return this.$toast.deleteSuccess();\n          }).then(() => {\n            this.isLoading = false;\n            this.fetchOrgStructure();\n          });\n        }\n      });\n    },\n    onAddOrglevel(node) {\n      if (this.editable) {\n        this.saveModalState = node;\n        this.showSaveModal = true;\n      }\n    },\n    onEditOrglevel(node) {\n      if (this.editable) {\n        this.editModalState = node;\n        this.showEditModal = true;\n      }\n    },\n    onSaveModalClose() {\n      this.saveModalState = null;\n      this.showSaveModal = false;\n      this.fetchOrgStructure();\n    },\n    onEditModalClose() {\n      this.editModalState = null;\n      this.showEditModal = false;\n      this.fetchOrgStructure();\n    },\n    fetchOrgStructure() {\n      this.isLoading = true;\n      this.http.getAll({\n        mode: 'tree'\n      }).then(response => {\n        const {\n          data\n        } = response.data;\n        this.data = data[0];\n      }).finally(() => {\n        this.isLoading = false;\n      });\n    }\n  }\n};","map":{"version":3,"mappings":"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","names":["OxdSheet","OxdSpinner","OxdTreeView","DEVICE_TYPES","useResponsive","OxdSwitchInput","OxdDropdownMenu","computed","SaveOrgUnit","EditOrgUnit","APIService","DeleteConfirmationDialog","components","setup","http","window","appGlobal","baseUrl","responsiveState","isMobile","screenType","DEVICE_LG","DEVICE_XL","data","isLoading","editable","showSaveModal","saveModalState","showEditModal","editModalState","created","fetchOrgStructure","methods","onDelete","node","$refs","deleteDialog","showDialog","then","confirmation","delete","id","$toast","deleteSuccess","onAddOrglevel","onEditOrglevel","onSaveModalClose","onEditModalClose","getAll","mode","response","finally"],"sourceRoot":"","sources":["C:\\xampp\\htdocs\\orangehrm-5.7\\src\\client\\src\\orangehrmAdminPlugin\\pages\\orgStructure\\OrgStructure.vue"],"sourcesContent":["<!--\n/**\n * OrangeHRM is a comprehensive Human Resource Management (HRM) System that captures\n * all the essential functionalities required for any enterprise.\n * Copyright (C) 2006 OrangeHRM Inc., http://www.orangehrm.com\n *\n * OrangeHRM is free software: you can redistribute it and/or modify it under the terms of\n * the GNU General Public License as published by the Free Software Foundation, either\n * version 3 of the License, or (at your option) any later version.\n *\n * OrangeHRM is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;\n * without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n * See the GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License along with OrangeHRM.\n * If not, see <https://www.gnu.org/licenses/>.\n */\n -->\n\n<template>\n  <div class=\"orangehrm-background-container\">\n    <div class=\"orangehrm-paper-container\">\n      <div class=\"orangehrm-header-container\">\n        <oxd-text tag=\"h6\" class=\"orangehrm-main-title\">\n          {{ $t('admin.organization_structure') }}\n        </oxd-text>\n        <oxd-switch-input\n          v-if=\"!isLoading\"\n          v-model=\"editable\"\n          :option-label=\"$t('general.edit')\"\n          label-position=\"left\"\n        />\n      </div>\n      <oxd-divider\n        v-if=\"!isLoading\"\n        class=\"orangehrm-horizontal-margin orangehrm-clear-margins\"\n      />\n      <div v-if=\"!isLoading\" class=\"org-root-container\">\n        <oxd-text\n          tag=\"p\"\n          :class=\"{\n            '--parent': data && data.children != 0,\n          }\"\n        >\n          {{ data.name }}\n        </oxd-text>\n        <oxd-button\n          v-show=\"editable\"\n          class=\"org-structure-add\"\n          :label=\"$t('general.add')\"\n          icon-name=\"plus\"\n          display-type=\"secondary\"\n          @click=\"onAddOrglevel(data)\"\n        />\n      </div>\n      <div class=\"org-container\">\n        <div v-if=\"isLoading\" class=\"loader\">\n          <oxd-loading-spinner />\n        </div>\n        <oxd-tree-view\n          v-else\n          :data=\"data\"\n          :open=\"true\"\n          :show-root=\"false\"\n          class=\"org-structure\"\n        >\n          <template #content=\"{nodeData}\">\n            <oxd-sheet\n              type=\"pastel-white\"\n              :class=\"{\n                'org-structure-card': true,\n                '--edit': editable,\n              }\"\n            >\n              <div class=\"org-name\">\n                {{\n                  nodeData.unitId\n                    ? `${nodeData.unitId}: ${nodeData.name}`\n                    : `${nodeData.name}`\n                }}\n              </div>\n              <div v-if=\"editable\" class=\"org-action\">\n                <oxd-dropdown v-if=\"isMobile\">\n                  <oxd-icon-button name=\"three-dots\" :with-container=\"true\" />\n                  <template #content>\n                    <li\n                      class=\"org-action-description\"\n                      @click=\"onDelete(nodeData)\"\n                    >\n                      <oxd-text tag=\"p\">\n                        {{ $t('performance.delete') }}\n                      </oxd-text>\n                    </li>\n                    <li\n                      class=\"org-action-description\"\n                      @click=\"onEditOrglevel(nodeData)\"\n                    >\n                      <oxd-text tag=\"p\">\n                        {{ $t('general.edit') }}\n                      </oxd-text>\n                    </li>\n                    <li\n                      class=\"org-action-description\"\n                      @click=\"onAddOrglevel(nodeData)\"\n                    >\n                      <oxd-text tag=\"p\">\n                        {{ $t('general.add') }}\n                      </oxd-text>\n                    </li>\n                  </template>\n                </oxd-dropdown>\n                <template v-else>\n                  <oxd-icon-button\n                    class=\"org-action-icon\"\n                    name=\"trash-fill\"\n                    role=\"none\"\n                    @click=\"onDelete(nodeData)\"\n                  />\n                  <oxd-icon-button\n                    class=\"org-action-icon\"\n                    name=\"pencil-fill\"\n                    role=\"none\"\n                    @click=\"onEditOrglevel(nodeData)\"\n                  />\n                  <oxd-icon-button\n                    class=\"org-action-icon\"\n                    name=\"plus\"\n                    role=\"none\"\n                    @click=\"onAddOrglevel(nodeData)\"\n                  />\n                </template>\n              </div>\n            </oxd-sheet>\n          </template>\n        </oxd-tree-view>\n      </div>\n    </div>\n    <delete-confirmation ref=\"deleteDialog\"></delete-confirmation>\n    <save-org-unit\n      v-if=\"showSaveModal\"\n      :data=\"saveModalState\"\n      @close=\"onSaveModalClose\"\n    ></save-org-unit>\n    <edit-org-unit\n      v-if=\"showEditModal\"\n      :data=\"editModalState\"\n      @close=\"onEditModalClose\"\n    ></edit-org-unit>\n  </div>\n</template>\n\n<script>\nimport {\n  OxdSheet,\n  OxdSpinner,\n  OxdTreeView,\n  DEVICE_TYPES,\n  useResponsive,\n  OxdSwitchInput,\n  OxdDropdownMenu,\n} from '@ohrm/oxd';\nimport {computed} from 'vue';\nimport SaveOrgUnit from './SaveOrgUnit';\nimport EditOrgUnit from './EditOrgUnit';\nimport {APIService} from '@/core/util/services/api.service';\nimport DeleteConfirmationDialog from '@ohrm/components/dialogs/DeleteConfirmationDialog';\n\nexport default {\n  components: {\n    'oxd-sheet': OxdSheet,\n    'save-org-unit': SaveOrgUnit,\n    'edit-org-unit': EditOrgUnit,\n    'oxd-tree-view': OxdTreeView,\n    'oxd-dropdown': OxdDropdownMenu,\n    'oxd-loading-spinner': OxdSpinner,\n    'oxd-switch-input': OxdSwitchInput,\n    'delete-confirmation': DeleteConfirmationDialog,\n  },\n  setup() {\n    const http = new APIService(\n      window.appGlobal.baseUrl,\n      '/api/v2/admin/subunits',\n    );\n    const responsiveState = useResponsive();\n    const isMobile = computed(() => {\n      return !(\n        responsiveState.screenType === DEVICE_TYPES.DEVICE_LG ||\n        responsiveState.screenType === DEVICE_TYPES.DEVICE_XL\n      );\n    });\n    return {\n      http,\n      isMobile,\n    };\n  },\n  data() {\n    return {\n      isLoading: false,\n      editable: false,\n      showSaveModal: false,\n      saveModalState: null,\n      showEditModal: false,\n      editModalState: null,\n      data: {},\n    };\n  },\n\n  created() {\n    this.fetchOrgStructure();\n  },\n  methods: {\n    onDelete(node) {\n      this.$refs.deleteDialog.showDialog().then((confirmation) => {\n        if (confirmation === 'ok') {\n          this.isLoading = true;\n          this.http\n            .delete(node.id)\n            .then(() => {\n              return this.$toast.deleteSuccess();\n            })\n            .then(() => {\n              this.isLoading = false;\n              this.fetchOrgStructure();\n            });\n        }\n      });\n    },\n    onAddOrglevel(node) {\n      if (this.editable) {\n        this.saveModalState = node;\n        this.showSaveModal = true;\n      }\n    },\n    onEditOrglevel(node) {\n      if (this.editable) {\n        this.editModalState = node;\n        this.showEditModal = true;\n      }\n    },\n    onSaveModalClose() {\n      this.saveModalState = null;\n      this.showSaveModal = false;\n      this.fetchOrgStructure();\n    },\n    onEditModalClose() {\n      this.editModalState = null;\n      this.showEditModal = false;\n      this.fetchOrgStructure();\n    },\n    fetchOrgStructure() {\n      this.isLoading = true;\n      this.http\n        .getAll({\n          mode: 'tree',\n        })\n        .then((response) => {\n          const {data} = response.data;\n          this.data = data[0];\n        })\n        .finally(() => {\n          this.isLoading = false;\n        });\n    },\n  },\n};\n</script>\n\n<style src=\"./org-structure.scss\" lang=\"scss\" scoped></style>\n\n<style lang=\"scss\">\n.oxd-tree-node-content {\n  width: 100%;\n}\n.oxd-tree-node-toggle {\n  & .oxd-icon-button {\n    background-color: $oxd-white-color !important;\n  }\n}\n</style>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}