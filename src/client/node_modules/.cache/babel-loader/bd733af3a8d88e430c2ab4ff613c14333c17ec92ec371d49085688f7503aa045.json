{"ast":null,"code":"import { toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, normalizeClass as _normalizeClass, vShow as _vShow, withDirectives as _withDirectives, createElementBlock as _createElementBlock, Fragment as _Fragment, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-1cc4d566\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"orangehrm-background-container\"\n};\nconst _hoisted_2 = {\n  class: \"orangehrm-paper-container\"\n};\nconst _hoisted_3 = {\n  class: \"orangehrm-header-container\"\n};\nconst _hoisted_4 = {\n  key: 1,\n  class: \"org-root-container\"\n};\nconst _hoisted_5 = {\n  class: \"org-container\"\n};\nconst _hoisted_6 = {\n  key: 0,\n  class: \"loader\"\n};\nconst _hoisted_7 = {\n  class: \"org-name\"\n};\nconst _hoisted_8 = {\n  key: 0,\n  class: \"org-action\"\n};\nconst _hoisted_9 = [\"onClick\"];\nconst _hoisted_10 = [\"onClick\"];\nconst _hoisted_11 = [\"onClick\"];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_oxd_text = _resolveComponent(\"oxd-text\");\n  const _component_oxd_switch_input = _resolveComponent(\"oxd-switch-input\");\n  const _component_oxd_divider = _resolveComponent(\"oxd-divider\");\n  const _component_oxd_button = _resolveComponent(\"oxd-button\");\n  const _component_oxd_loading_spinner = _resolveComponent(\"oxd-loading-spinner\");\n  const _component_oxd_icon_button = _resolveComponent(\"oxd-icon-button\");\n  const _component_oxd_dropdown = _resolveComponent(\"oxd-dropdown\");\n  const _component_oxd_sheet = _resolveComponent(\"oxd-sheet\");\n  const _component_oxd_tree_view = _resolveComponent(\"oxd-tree-view\");\n  const _component_delete_confirmation = _resolveComponent(\"delete-confirmation\");\n  const _component_save_org_unit = _resolveComponent(\"save-org-unit\");\n  const _component_edit_org_unit = _resolveComponent(\"edit-org-unit\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"div\", _hoisted_3, [_createVNode(_component_oxd_text, {\n    tag: \"h6\",\n    class: \"orangehrm-main-title\"\n  }, {\n    default: _withCtx(() => [_createTextVNode(_toDisplayString(_ctx.$t('admin.organization_structure')), 1)]),\n    _: 1\n  }), !$data.isLoading ? (_openBlock(), _createBlock(_component_oxd_switch_input, {\n    key: 0,\n    modelValue: $data.editable,\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.editable = $event),\n    \"option-label\": _ctx.$t('general.edit'),\n    \"label-position\": \"left\"\n  }, null, 8, [\"modelValue\", \"option-label\"])) : _createCommentVNode(\"\", true)]), !$data.isLoading ? (_openBlock(), _createBlock(_component_oxd_divider, {\n    key: 0,\n    class: \"orangehrm-horizontal-margin orangehrm-clear-margins\"\n  })) : _createCommentVNode(\"\", true), !$data.isLoading ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [_createVNode(_component_oxd_text, {\n    tag: \"p\",\n    class: _normalizeClass({\n      '--parent': $data.data && $data.data.children != 0\n    })\n  }, {\n    default: _withCtx(() => [_createTextVNode(_toDisplayString($data.data.name), 1)]),\n    _: 1\n  }, 8, [\"class\"]), _withDirectives(_createVNode(_component_oxd_button, {\n    class: \"org-structure-add\",\n    label: _ctx.$t('general.add'),\n    \"icon-name\": \"plus\",\n    \"display-type\": \"secondary\",\n    onClick: _cache[1] || (_cache[1] = $event => $options.onAddOrglevel($data.data))\n  }, null, 8, [\"label\"]), [[_vShow, $data.editable]])])) : _createCommentVNode(\"\", true), _createElementVNode(\"div\", _hoisted_5, [$data.isLoading ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [_createVNode(_component_oxd_loading_spinner)])) : (_openBlock(), _createBlock(_component_oxd_tree_view, {\n    key: 1,\n    data: $data.data,\n    open: true,\n    \"show-root\": false,\n    class: \"org-structure\"\n  }, {\n    content: _withCtx(({\n      nodeData\n    }) => [_createVNode(_component_oxd_sheet, {\n      type: \"pastel-white\",\n      class: _normalizeClass({\n        'org-structure-card': true,\n        '--edit': $data.editable\n      })\n    }, {\n      default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_7, _toDisplayString(nodeData.unitId ? `${nodeData.unitId}: ${nodeData.name}` : `${nodeData.name}`), 1), $data.editable ? (_openBlock(), _createElementBlock(\"div\", _hoisted_8, [$setup.isMobile ? (_openBlock(), _createBlock(_component_oxd_dropdown, {\n        key: 0\n      }, {\n        content: _withCtx(() => [_createElementVNode(\"li\", {\n          class: \"org-action-description\",\n          onClick: $event => $options.onDelete(nodeData)\n        }, [_createVNode(_component_oxd_text, {\n          tag: \"p\"\n        }, {\n          default: _withCtx(() => [_createTextVNode(_toDisplayString(_ctx.$t('performance.delete')), 1)]),\n          _: 1\n        })], 8, _hoisted_9), _createElementVNode(\"li\", {\n          class: \"org-action-description\",\n          onClick: $event => $options.onEditOrglevel(nodeData)\n        }, [_createVNode(_component_oxd_text, {\n          tag: \"p\"\n        }, {\n          default: _withCtx(() => [_createTextVNode(_toDisplayString(_ctx.$t('general.edit')), 1)]),\n          _: 1\n        })], 8, _hoisted_10), _createElementVNode(\"li\", {\n          class: \"org-action-description\",\n          onClick: $event => $options.onAddOrglevel(nodeData)\n        }, [_createVNode(_component_oxd_text, {\n          tag: \"p\"\n        }, {\n          default: _withCtx(() => [_createTextVNode(_toDisplayString(_ctx.$t('general.add')), 1)]),\n          _: 1\n        })], 8, _hoisted_11)]),\n        default: _withCtx(() => [_createVNode(_component_oxd_icon_button, {\n          name: \"three-dots\",\n          \"with-container\": true\n        })]),\n        _: 2\n      }, 1024)) : (_openBlock(), _createElementBlock(_Fragment, {\n        key: 1\n      }, [_createVNode(_component_oxd_icon_button, {\n        class: \"org-action-icon\",\n        name: \"trash-fill\",\n        role: \"none\",\n        onClick: $event => $options.onDelete(nodeData)\n      }, null, 8, [\"onClick\"]), _createVNode(_component_oxd_icon_button, {\n        class: \"org-action-icon\",\n        name: \"pencil-fill\",\n        role: \"none\",\n        onClick: $event => $options.onEditOrglevel(nodeData)\n      }, null, 8, [\"onClick\"]), _createVNode(_component_oxd_icon_button, {\n        class: \"org-action-icon\",\n        name: \"plus\",\n        role: \"none\",\n        onClick: $event => $options.onAddOrglevel(nodeData)\n      }, null, 8, [\"onClick\"])], 64))])) : _createCommentVNode(\"\", true)]),\n      _: 2\n    }, 1032, [\"class\"])]),\n    _: 1\n  }, 8, [\"data\"]))])]), _createVNode(_component_delete_confirmation, {\n    ref: \"deleteDialog\"\n  }, null, 512), $data.showSaveModal ? (_openBlock(), _createBlock(_component_save_org_unit, {\n    key: 0,\n    data: $data.saveModalState,\n    onClose: $options.onSaveModalClose\n  }, null, 8, [\"data\", \"onClose\"])) : _createCommentVNode(\"\", true), $data.showEditModal ? (_openBlock(), _createBlock(_component_edit_org_unit, {\n    key: 1,\n    data: $data.editModalState,\n    onClose: $options.onEditModalClose\n  }, null, 8, [\"data\", \"onClose\"])) : _createCommentVNode(\"\", true)]);\n}","map":{"version":3,"mappings":"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","names":["class","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_createVNode","_component_oxd_text","tag","_ctx","$data","_createBlock","_component_oxd_switch_input","_component_oxd_divider","_hoisted_4","children","name","_component_oxd_button","label","onClick","$options","_hoisted_5","_hoisted_6","_component_oxd_loading_spinner","_component_oxd_tree_view","data","open","content","nodeData","_component_oxd_sheet","type","_hoisted_7","unitId","_hoisted_8","$setup","_component_oxd_dropdown","key","_component_oxd_icon_button","_Fragment","role","_component_delete_confirmation","ref","_component_save_org_unit","onClose","_component_edit_org_unit"],"sourceRoot":"","sources":["C:\\xampp\\htdocs\\orangehrm-5.7\\src\\client\\src\\orangehrmAdminPlugin\\pages\\orgStructure\\OrgStructure.vue"],"sourcesContent":["<!--\n/**\n * OrangeHRM is a comprehensive Human Resource Management (HRM) System that captures\n * all the essential functionalities required for any enterprise.\n * Copyright (C) 2006 OrangeHRM Inc., http://www.orangehrm.com\n *\n * OrangeHRM is free software: you can redistribute it and/or modify it under the terms of\n * the GNU General Public License as published by the Free Software Foundation, either\n * version 3 of the License, or (at your option) any later version.\n *\n * OrangeHRM is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;\n * without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n * See the GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License along with OrangeHRM.\n * If not, see <https://www.gnu.org/licenses/>.\n */\n -->\n\n<template>\n  <div class=\"orangehrm-background-container\">\n    <div class=\"orangehrm-paper-container\">\n      <div class=\"orangehrm-header-container\">\n        <oxd-text tag=\"h6\" class=\"orangehrm-main-title\">\n          {{ $t('admin.organization_structure') }}\n        </oxd-text>\n        <oxd-switch-input\n          v-if=\"!isLoading\"\n          v-model=\"editable\"\n          :option-label=\"$t('general.edit')\"\n          label-position=\"left\"\n        />\n      </div>\n      <oxd-divider\n        v-if=\"!isLoading\"\n        class=\"orangehrm-horizontal-margin orangehrm-clear-margins\"\n      />\n      <div v-if=\"!isLoading\" class=\"org-root-container\">\n        <oxd-text\n          tag=\"p\"\n          :class=\"{\n            '--parent': data && data.children != 0,\n          }\"\n        >\n          {{ data.name }}\n        </oxd-text>\n        <oxd-button\n          v-show=\"editable\"\n          class=\"org-structure-add\"\n          :label=\"$t('general.add')\"\n          icon-name=\"plus\"\n          display-type=\"secondary\"\n          @click=\"onAddOrglevel(data)\"\n        />\n      </div>\n      <div class=\"org-container\">\n        <div v-if=\"isLoading\" class=\"loader\">\n          <oxd-loading-spinner />\n        </div>\n        <oxd-tree-view\n          v-else\n          :data=\"data\"\n          :open=\"true\"\n          :show-root=\"false\"\n          class=\"org-structure\"\n        >\n          <template #content=\"{nodeData}\">\n            <oxd-sheet\n              type=\"pastel-white\"\n              :class=\"{\n                'org-structure-card': true,\n                '--edit': editable,\n              }\"\n            >\n              <div class=\"org-name\">\n                {{\n                  nodeData.unitId\n                    ? `${nodeData.unitId}: ${nodeData.name}`\n                    : `${nodeData.name}`\n                }}\n              </div>\n              <div v-if=\"editable\" class=\"org-action\">\n                <oxd-dropdown v-if=\"isMobile\">\n                  <oxd-icon-button name=\"three-dots\" :with-container=\"true\" />\n                  <template #content>\n                    <li\n                      class=\"org-action-description\"\n                      @click=\"onDelete(nodeData)\"\n                    >\n                      <oxd-text tag=\"p\">\n                        {{ $t('performance.delete') }}\n                      </oxd-text>\n                    </li>\n                    <li\n                      class=\"org-action-description\"\n                      @click=\"onEditOrglevel(nodeData)\"\n                    >\n                      <oxd-text tag=\"p\">\n                        {{ $t('general.edit') }}\n                      </oxd-text>\n                    </li>\n                    <li\n                      class=\"org-action-description\"\n                      @click=\"onAddOrglevel(nodeData)\"\n                    >\n                      <oxd-text tag=\"p\">\n                        {{ $t('general.add') }}\n                      </oxd-text>\n                    </li>\n                  </template>\n                </oxd-dropdown>\n                <template v-else>\n                  <oxd-icon-button\n                    class=\"org-action-icon\"\n                    name=\"trash-fill\"\n                    role=\"none\"\n                    @click=\"onDelete(nodeData)\"\n                  />\n                  <oxd-icon-button\n                    class=\"org-action-icon\"\n                    name=\"pencil-fill\"\n                    role=\"none\"\n                    @click=\"onEditOrglevel(nodeData)\"\n                  />\n                  <oxd-icon-button\n                    class=\"org-action-icon\"\n                    name=\"plus\"\n                    role=\"none\"\n                    @click=\"onAddOrglevel(nodeData)\"\n                  />\n                </template>\n              </div>\n            </oxd-sheet>\n          </template>\n        </oxd-tree-view>\n      </div>\n    </div>\n    <delete-confirmation ref=\"deleteDialog\"></delete-confirmation>\n    <save-org-unit\n      v-if=\"showSaveModal\"\n      :data=\"saveModalState\"\n      @close=\"onSaveModalClose\"\n    ></save-org-unit>\n    <edit-org-unit\n      v-if=\"showEditModal\"\n      :data=\"editModalState\"\n      @close=\"onEditModalClose\"\n    ></edit-org-unit>\n  </div>\n</template>\n\n<script>\nimport {\n  OxdSheet,\n  OxdSpinner,\n  OxdTreeView,\n  DEVICE_TYPES,\n  useResponsive,\n  OxdSwitchInput,\n  OxdDropdownMenu,\n} from '@ohrm/oxd';\nimport {computed} from 'vue';\nimport SaveOrgUnit from './SaveOrgUnit';\nimport EditOrgUnit from './EditOrgUnit';\nimport {APIService} from '@/core/util/services/api.service';\nimport DeleteConfirmationDialog from '@ohrm/components/dialogs/DeleteConfirmationDialog';\n\nexport default {\n  components: {\n    'oxd-sheet': OxdSheet,\n    'save-org-unit': SaveOrgUnit,\n    'edit-org-unit': EditOrgUnit,\n    'oxd-tree-view': OxdTreeView,\n    'oxd-dropdown': OxdDropdownMenu,\n    'oxd-loading-spinner': OxdSpinner,\n    'oxd-switch-input': OxdSwitchInput,\n    'delete-confirmation': DeleteConfirmationDialog,\n  },\n  setup() {\n    const http = new APIService(\n      window.appGlobal.baseUrl,\n      '/api/v2/admin/subunits',\n    );\n    const responsiveState = useResponsive();\n    const isMobile = computed(() => {\n      return !(\n        responsiveState.screenType === DEVICE_TYPES.DEVICE_LG ||\n        responsiveState.screenType === DEVICE_TYPES.DEVICE_XL\n      );\n    });\n    return {\n      http,\n      isMobile,\n    };\n  },\n  data() {\n    return {\n      isLoading: false,\n      editable: false,\n      showSaveModal: false,\n      saveModalState: null,\n      showEditModal: false,\n      editModalState: null,\n      data: {},\n    };\n  },\n\n  created() {\n    this.fetchOrgStructure();\n  },\n  methods: {\n    onDelete(node) {\n      this.$refs.deleteDialog.showDialog().then((confirmation) => {\n        if (confirmation === 'ok') {\n          this.isLoading = true;\n          this.http\n            .delete(node.id)\n            .then(() => {\n              return this.$toast.deleteSuccess();\n            })\n            .then(() => {\n              this.isLoading = false;\n              this.fetchOrgStructure();\n            });\n        }\n      });\n    },\n    onAddOrglevel(node) {\n      if (this.editable) {\n        this.saveModalState = node;\n        this.showSaveModal = true;\n      }\n    },\n    onEditOrglevel(node) {\n      if (this.editable) {\n        this.editModalState = node;\n        this.showEditModal = true;\n      }\n    },\n    onSaveModalClose() {\n      this.saveModalState = null;\n      this.showSaveModal = false;\n      this.fetchOrgStructure();\n    },\n    onEditModalClose() {\n      this.editModalState = null;\n      this.showEditModal = false;\n      this.fetchOrgStructure();\n    },\n    fetchOrgStructure() {\n      this.isLoading = true;\n      this.http\n        .getAll({\n          mode: 'tree',\n        })\n        .then((response) => {\n          const {data} = response.data;\n          this.data = data[0];\n        })\n        .finally(() => {\n          this.isLoading = false;\n        });\n    },\n  },\n};\n</script>\n\n<style src=\"./org-structure.scss\" lang=\"scss\" scoped></style>\n\n<style lang=\"scss\">\n.oxd-tree-node-content {\n  width: 100%;\n}\n.oxd-tree-node-toggle {\n  & .oxd-icon-button {\n    background-color: $oxd-white-color !important;\n  }\n}\n</style>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}