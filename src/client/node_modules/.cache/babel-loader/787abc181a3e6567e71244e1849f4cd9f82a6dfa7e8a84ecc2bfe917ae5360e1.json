{"ast":null,"code":"import { renderSlot as _renderSlot, createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, renderList as _renderList, Fragment as _Fragment, createBlock as _createBlock, vShow as _vShow, withDirectives as _withDirectives, createTextVNode as _createTextVNode, withCtx as _withCtx, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-11ac24dc\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"orangehrm-timesheet-header\"\n};\nconst _hoisted_2 = {\n  class: \"orangehrm-timesheet-header--title\"\n};\nconst _hoisted_3 = {\n  class: \"orangehrm-timesheet-header--options\"\n};\nconst _hoisted_4 = {\n  key: 0,\n  class: \"orangehrm-timesheet-loader\"\n};\nconst _hoisted_5 = {\n  key: 1,\n  class: \"orangehrm-timesheet-body-message\"\n};\nconst _hoisted_6 = {\n  key: 2,\n  class: \"orangehrm-timesheet-body\"\n};\nconst _hoisted_7 = {\n  class: \"orangehrm-timesheet-table-header\"\n};\nconst _hoisted_8 = {\n  class: \"orangehrm-timesheet-table-header-row\"\n};\nconst _hoisted_9 = {\n  class: \"orangehrm-timesheet-table-header-cell\"\n};\nconst _hoisted_10 = {\n  class: \"--day\"\n};\nconst _hoisted_11 = {\n  key: 0,\n  class: \"orangehrm-timesheet-table-header-cell --center --freeze-right\"\n};\nconst _hoisted_12 = {\n  class: \"orangehrm-timesheet-table-body\"\n};\nconst _hoisted_13 = {\n  key: 1\n};\nconst _hoisted_14 = {\n  class: \"orangehrm-timesheet-table-body-cell\"\n};\nconst _hoisted_15 = {\n  key: 1\n};\nconst _hoisted_16 = {\n  key: 1\n};\nconst _hoisted_17 = {\n  key: 0,\n  class: \"orangehrm-timesheet-table-body-cell --center --freeze-right --highlight\"\n};\nconst _hoisted_18 = {\n  key: 1,\n  class: \"orangehrm-timesheet-table-body-cell --flex\"\n};\nconst _hoisted_19 = {\n  key: 0,\n  class: \"orangehrm-timesheet-table-body-row --total\"\n};\nconst _hoisted_20 = {\n  class: \"orangehrm-timesheet-table-body-cell --freeze-left --highlight\"\n};\nconst _hoisted_21 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"td\", null, null, -1));\nconst _hoisted_22 = {\n  class: \"orangehrm-timesheet-table-body-cell --center --freeze-right --highlight-2\"\n};\nconst _hoisted_23 = {\n  key: 1,\n  class: \"orangehrm-timesheet-table-body-row\"\n};\nconst _hoisted_24 = {\n  class: \"orangehrm-timesheet-table-body-cell --flex\"\n};\nconst _hoisted_25 = {\n  key: 2,\n  class: \"orangehrm-timesheet-table-body-row\"\n};\nconst _hoisted_26 = {\n  colspan: \"9\",\n  class: \"orangehrm-timesheet-table-body-cell\"\n};\nconst _hoisted_27 = {\n  class: \"orangehrm-timesheet-footer\"\n};\nconst _hoisted_28 = {\n  class: \"orangehrm-timesheet-footer--title\"\n};\nconst _hoisted_29 = {\n  class: \"orangehrm-timesheet-footer--options\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_oxd_loading_spinner = _resolveComponent(\"oxd-loading-spinner\");\n  const _component_oxd_alert = _resolveComponent(\"oxd-alert\");\n  const _component_project_autocomplete = _resolveComponent(\"project-autocomplete\");\n  const _component_activity_dropdown = _resolveComponent(\"activity-dropdown\");\n  const _component_oxd_icon_button = _resolveComponent(\"oxd-icon-button\");\n  const _component_oxd_input_field = _resolveComponent(\"oxd-input-field\");\n  const _component_oxd_text = _resolveComponent(\"oxd-text\");\n  const _component_timesheet_comment_modal = _resolveComponent(\"timesheet-comment-modal\");\n  const _component_oxd_form = _resolveComponent(\"oxd-form\");\n  return _openBlock(), _createBlock(_component_oxd_form, {\n    class: \"orangehrm-paper-container\"\n  }, {\n    default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_renderSlot(_ctx.$slots, \"header-title\", {}, undefined, true)]), _createElementVNode(\"div\", _hoisted_3, [_renderSlot(_ctx.$slots, \"header-options\", {}, undefined, true)])]), $props.loading ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [_createVNode(_component_oxd_loading_spinner)])) : !$props.loading && !$props.columns ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [_createVNode(_component_oxd_alert, {\n      type: \"warn\",\n      show: true,\n      message: _ctx.$t('time.no_timesheets_found')\n    }, null, 8, [\"message\"])])) : (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [_createElementVNode(\"table\", {\n      class: _normalizeClass($options.tableClasses)\n    }, [_createElementVNode(\"thead\", _hoisted_7, [_createElementVNode(\"tr\", _hoisted_8, [_createElementVNode(\"th\", {\n      class: _normalizeClass($options.fixedColumnClasses)\n    }, _toDisplayString(_ctx.$t('time.project')), 3), _createElementVNode(\"th\", _hoisted_9, _toDisplayString(_ctx.$t('time.activity')), 1), (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($options.daysOfWeek, day => {\n      return _openBlock(), _createElementBlock(\"th\", {\n        key: day.id,\n        class: \"orangehrm-timesheet-table-header-cell --center\"\n      }, [_createElementVNode(\"span\", _hoisted_10, _toDisplayString(day.day), 1), _createElementVNode(\"span\", null, _toDisplayString(day.title), 1)]);\n    }), 128)), !$props.editable ? (_openBlock(), _createElementBlock(\"th\", _hoisted_11, _toDisplayString(_ctx.$t('general.total')), 1)) : _createCommentVNode(\"\", true)])]), _createElementVNode(\"tbody\", _hoisted_12, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($props.records, (record, i) => {\n      return _openBlock(), _createElementBlock(\"tr\", {\n        key: record,\n        class: \"orangehrm-timesheet-table-body-row\"\n      }, [_createElementVNode(\"td\", {\n        class: _normalizeClass($options.fixedCellClasses)\n      }, [$props.editable ? (_openBlock(), _createBlock(_component_project_autocomplete, {\n        key: 0,\n        \"only-allowed\": false,\n        rules: $data.rules.project,\n        \"model-value\": $options.getProject(record),\n        \"onUpdate:modelValue\": $event => $options.updateProject($event, i)\n      }, null, 8, [\"rules\", \"model-value\", \"onUpdate:modelValue\"])) : (_openBlock(), _createElementBlock(\"span\", _hoisted_13, _toDisplayString(record.project ? `${record.customer.name} - ${record.project.name}` : ''), 1))], 2), _createElementVNode(\"td\", _hoisted_14, [$props.editable ? (_openBlock(), _createBlock(_component_activity_dropdown, {\n        key: 0,\n        rules: $data.rules.activity,\n        \"project-id\": record.project && record.project.id,\n        \"model-value\": $options.getActivity(record.activity),\n        \"onUpdate:modelValue\": $event => $options.updateActivity($event, i)\n      }, null, 8, [\"rules\", \"project-id\", \"model-value\", \"onUpdate:modelValue\"])) : (_openBlock(), _createElementBlock(\"span\", _hoisted_15, _toDisplayString(record.activity && record.activity.name), 1))]), (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($props.columns, (column, date) => {\n        return _openBlock(), _createElementBlock(\"td\", {\n          key: `${record.project}_${record.activity}_${date}`,\n          class: _normalizeClass({\n            'orangehrm-timesheet-table-body-cell': true,\n            '--center': true,\n            '--duration-input': $props.editable,\n            '--highlight-3': !$props.editable && column.workday\n          })\n        }, [_withDirectives(_createVNode(_component_oxd_icon_button, {\n          \"display-type\": \"secondary\",\n          class: \"orangehrm-timesheet-icon-comment\",\n          name: $options.getCommentIcon(record.dates[date]),\n          onMousedown: $event => $options.viewComment(record, record.dates[date], i, date)\n        }, null, 8, [\"name\", \"onMousedown\"]), [[_vShow, $options.isCommentVisible(record.dates[date], i, date)]]), $props.editable ? (_openBlock(), _createBlock(_component_oxd_input_field, {\n          key: 0,\n          autocomplete: \"off\",\n          rules: $options.validateDuration(date),\n          \"model-value\": $options.getDuration(record.dates[date]),\n          onBlur: $options.onDurationBlur,\n          onFocus: $event => $options.onDurationFocus(i, date),\n          \"onUpdate:modelValue\": $event => $options.updateTime($event, i, date)\n        }, null, 8, [\"rules\", \"model-value\", \"onBlur\", \"onFocus\", \"onUpdate:modelValue\"])) : (_openBlock(), _createElementBlock(\"span\", _hoisted_16, _toDisplayString($options.getDuration(record.dates[date]) ?? '00:00'), 1))], 2);\n      }), 128)), !$props.editable ? (_openBlock(), _createElementBlock(\"td\", _hoisted_17, _toDisplayString(record.total.label), 1)) : _createCommentVNode(\"\", true), $props.editable ? (_openBlock(), _createElementBlock(\"td\", _hoisted_18, [_createVNode(_component_oxd_icon_button, {\n        name: \"trash\",\n        class: \"orangehrm-timesheet-icon\",\n        onClick: $event => $options.deleteRow(i)\n      }, null, 8, [\"onClick\"])])) : _createCommentVNode(\"\", true)]);\n    }), 128)), !$props.editable && $props.records.length > 0 ? (_openBlock(), _createElementBlock(\"tr\", _hoisted_19, [_createElementVNode(\"td\", _hoisted_20, _toDisplayString(_ctx.$t('general.total')), 1), _hoisted_21, (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($props.columns, date => {\n      return _openBlock(), _createElementBlock(\"td\", {\n        key: `total-${date}`,\n        class: \"orangehrm-timesheet-table-body-cell --center\"\n      }, _toDisplayString(date.total.label), 1);\n    }), 128)), _createElementVNode(\"td\", _hoisted_22, _toDisplayString($props.subtotal), 1)])) : _createCommentVNode(\"\", true), $props.editable ? (_openBlock(), _createElementBlock(\"tr\", _hoisted_23, [_createElementVNode(\"td\", _hoisted_24, [_createVNode(_component_oxd_icon_button, {\n      name: \"plus\",\n      class: \"orangehrm-timesheet-icon\",\n      onClick: $options.addRow\n    }, null, 8, [\"onClick\"]), _createVNode(_component_oxd_text, {\n      type: \"subtitle-2\"\n    }, {\n      default: _withCtx(() => [_createTextVNode(_toDisplayString(_ctx.$t('time.add_row')), 1)]),\n      _: 1\n    })])])) : _createCommentVNode(\"\", true), $props.records.length === 0 ? (_openBlock(), _createElementBlock(\"tr\", _hoisted_25, [_createElementVNode(\"td\", _hoisted_26, _toDisplayString(_ctx.$t('general.no_records_found')), 1)])) : _createCommentVNode(\"\", true)])], 2)])), _createElementVNode(\"div\", _hoisted_27, [_createElementVNode(\"div\", _hoisted_28, [_renderSlot(_ctx.$slots, \"footer-title\", {}, undefined, true)]), _createElementVNode(\"div\", _hoisted_29, [_renderSlot(_ctx.$slots, \"footer-options\", {}, undefined, true)])]), $data.showCommentModal ? (_openBlock(), _createBlock(_component_timesheet_comment_modal, {\n      key: 3,\n      editable: $props.editable,\n      data: $data.commentModalState,\n      \"timesheet-id\": $props.timesheetId,\n      onClose: $options.onCommentModalClose\n    }, null, 8, [\"editable\", \"data\", \"timesheet-id\", \"onClose\"])) : _createCommentVNode(\"\", true)]),\n    _: 3\n  });\n}","map":{"version":3,"mappings":"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","names":["class","_createElementVNode","colspan","_createBlock","_component_oxd_form","_hoisted_1","_hoisted_2","_renderSlot","_ctx","_hoisted_3","$props","_createElementBlock","_hoisted_4","_createVNode","_component_oxd_loading_spinner","_hoisted_5","_component_oxd_alert","type","show","message","_hoisted_6","$options","_hoisted_7","_hoisted_8","_hoisted_9","_Fragment","day","key","id","_hoisted_10","title","_hoisted_11","_hoisted_12","record","i","_component_project_autocomplete","rules","$data","project","$event","customer","name","_hoisted_14","_component_activity_dropdown","activity","column","date","workday","_component_oxd_icon_button","dates","onMousedown","_component_oxd_input_field","autocomplete","onBlur","onFocus","_hoisted_17","total","label","_hoisted_18","onClick","length","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24","_component_oxd_text","_hoisted_25","_hoisted_26","_hoisted_27","_hoisted_28","_hoisted_29","_component_timesheet_comment_modal","editable","data","onClose"],"sourceRoot":"","sources":["C:\\xampp\\htdocs\\orangehrm-5.7\\src\\client\\src\\orangehrmTimePlugin\\components\\Timesheet.vue"],"sourcesContent":["<!--\n/**\n * OrangeHRM is a comprehensive Human Resource Management (HRM) System that captures\n * all the essential functionalities required for any enterprise.\n * Copyright (C) 2006 OrangeHRM Inc., http://www.orangehrm.com\n *\n * OrangeHRM is free software: you can redistribute it and/or modify it under the terms of\n * the GNU General Public License as published by the Free Software Foundation, either\n * version 3 of the License, or (at your option) any later version.\n *\n * OrangeHRM is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;\n * without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n * See the GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License along with OrangeHRM.\n * If not, see <https://www.gnu.org/licenses/>.\n */\n -->\n\n<template>\n  <oxd-form class=\"orangehrm-paper-container\">\n    <div class=\"orangehrm-timesheet-header\">\n      <div class=\"orangehrm-timesheet-header--title\">\n        <slot name=\"header-title\"></slot>\n      </div>\n      <div class=\"orangehrm-timesheet-header--options\">\n        <slot name=\"header-options\"></slot>\n      </div>\n    </div>\n\n    <div v-if=\"loading\" class=\"orangehrm-timesheet-loader\">\n      <oxd-loading-spinner />\n    </div>\n    <div\n      v-else-if=\"!loading && !columns\"\n      class=\"orangehrm-timesheet-body-message\"\n    >\n      <oxd-alert\n        type=\"warn\"\n        :show=\"true\"\n        :message=\"$t('time.no_timesheets_found')\"\n      ></oxd-alert>\n    </div>\n\n    <div v-else class=\"orangehrm-timesheet-body\">\n      <table :class=\"tableClasses\">\n        <thead class=\"orangehrm-timesheet-table-header\">\n          <tr class=\"orangehrm-timesheet-table-header-row\">\n            <th :class=\"fixedColumnClasses\">\n              {{ $t('time.project') }}\n            </th>\n            <th class=\"orangehrm-timesheet-table-header-cell\">\n              {{ $t('time.activity') }}\n            </th>\n\n            <!-- timesheet days of week -->\n            <th\n              v-for=\"day in daysOfWeek\"\n              :key=\"day.id\"\n              class=\"orangehrm-timesheet-table-header-cell --center\"\n            >\n              <span class=\"--day\">\n                {{ day.day }}\n              </span>\n              <span>\n                {{ day.title }}\n              </span>\n            </th>\n            <!-- timesheet days of week -->\n\n            <th\n              v-if=\"!editable\"\n              class=\"orangehrm-timesheet-table-header-cell --center --freeze-right\"\n            >\n              {{ $t('general.total') }}\n            </th>\n          </tr>\n        </thead>\n\n        <tbody class=\"orangehrm-timesheet-table-body\">\n          <!-- timesheet activities -->\n          <tr\n            v-for=\"(record, i) in records\"\n            :key=\"record\"\n            class=\"orangehrm-timesheet-table-body-row\"\n          >\n            <td :class=\"fixedCellClasses\">\n              <project-autocomplete\n                v-if=\"editable\"\n                :only-allowed=\"false\"\n                :rules=\"rules.project\"\n                :model-value=\"getProject(record)\"\n                @update:model-value=\"updateProject($event, i)\"\n              />\n              <span v-else>\n                {{\n                  record.project\n                    ? `${record.customer.name} - ${record.project.name}`\n                    : ''\n                }}\n              </span>\n            </td>\n            <td class=\"orangehrm-timesheet-table-body-cell\">\n              <activity-dropdown\n                v-if=\"editable\"\n                :rules=\"rules.activity\"\n                :project-id=\"record.project && record.project.id\"\n                :model-value=\"getActivity(record.activity)\"\n                @update:model-value=\"updateActivity($event, i)\"\n              />\n              <span v-else>{{ record.activity && record.activity.name }}</span>\n            </td>\n            <td\n              v-for=\"(column, date) in columns\"\n              :key=\"`${record.project}_${record.activity}_${date}`\"\n              :class=\"{\n                'orangehrm-timesheet-table-body-cell': true,\n                '--center': true,\n                '--duration-input': editable,\n                '--highlight-3': !editable && column.workday,\n              }\"\n            >\n              <oxd-icon-button\n                v-show=\"isCommentVisible(record.dates[date], i, date)\"\n                display-type=\"secondary\"\n                class=\"orangehrm-timesheet-icon-comment\"\n                :name=\"getCommentIcon(record.dates[date])\"\n                @mousedown=\"viewComment(record, record.dates[date], i, date)\"\n              />\n              <oxd-input-field\n                v-if=\"editable\"\n                autocomplete=\"off\"\n                :rules=\"validateDuration(date)\"\n                :model-value=\"getDuration(record.dates[date])\"\n                @blur=\"onDurationBlur\"\n                @focus=\"onDurationFocus(i, date)\"\n                @update:model-value=\"updateTime($event, i, date)\"\n              />\n              <span v-else>\n                {{ getDuration(record.dates[date]) ?? '00:00' }}\n              </span>\n            </td>\n            <td\n              v-if=\"!editable\"\n              class=\"orangehrm-timesheet-table-body-cell --center --freeze-right --highlight\"\n            >\n              {{ record.total.label }}\n            </td>\n            <td\n              v-if=\"editable\"\n              class=\"orangehrm-timesheet-table-body-cell --flex\"\n            >\n              <oxd-icon-button\n                name=\"trash\"\n                class=\"orangehrm-timesheet-icon\"\n                @click=\"deleteRow(i)\"\n              />\n            </td>\n          </tr>\n          <!-- timesheet activities -->\n\n          <!-- totals -->\n          <tr\n            v-if=\"!editable && records.length > 0\"\n            class=\"orangehrm-timesheet-table-body-row --total\"\n          >\n            <td\n              class=\"orangehrm-timesheet-table-body-cell --freeze-left --highlight\"\n            >\n              {{ $t('general.total') }}\n            </td>\n            <td></td>\n            <!-- total per day -->\n            <td\n              v-for=\"date in columns\"\n              :key=\"`total-${date}`\"\n              class=\"orangehrm-timesheet-table-body-cell --center\"\n            >\n              {{ date.total.label }}\n            </td>\n            <!-- total per day -->\n            <td\n              class=\"orangehrm-timesheet-table-body-cell --center --freeze-right --highlight-2\"\n            >\n              {{ subtotal }}\n            </td>\n          </tr>\n          <!-- totals -->\n\n          <!-- add row -->\n          <tr v-if=\"editable\" class=\"orangehrm-timesheet-table-body-row\">\n            <td class=\"orangehrm-timesheet-table-body-cell --flex\">\n              <oxd-icon-button\n                name=\"plus\"\n                class=\"orangehrm-timesheet-icon\"\n                @click=\"addRow\"\n              />\n              <oxd-text type=\"subtitle-2\">\n                {{ $t('time.add_row') }}\n              </oxd-text>\n            </td>\n          </tr>\n          <!-- add row -->\n\n          <tr\n            v-if=\"records.length === 0\"\n            class=\"orangehrm-timesheet-table-body-row\"\n          >\n            <td colspan=\"9\" class=\"orangehrm-timesheet-table-body-cell\">\n              {{ $t('general.no_records_found') }}\n            </td>\n          </tr>\n        </tbody>\n      </table>\n    </div>\n\n    <div class=\"orangehrm-timesheet-footer\">\n      <div class=\"orangehrm-timesheet-footer--title\">\n        <slot name=\"footer-title\"></slot>\n      </div>\n      <div class=\"orangehrm-timesheet-footer--options\">\n        <slot name=\"footer-options\"></slot>\n      </div>\n    </div>\n\n    <timesheet-comment-modal\n      v-if=\"showCommentModal\"\n      :editable=\"editable\"\n      :data=\"commentModalState\"\n      :timesheet-id=\"timesheetId\"\n      @close=\"onCommentModalClose\"\n    ></timesheet-comment-modal>\n  </oxd-form>\n</template>\n\n<script>\nimport {validSelection} from '@/core/util/validation/rules';\nimport {parseDate, parseTimeInSeconds} from '@ohrm/core/util/helper/datefns';\nimport ActivityDropdown from '@/orangehrmTimePlugin/components/ActivityDropdown.vue';\nimport ProjectAutocomplete from '@/orangehrmTimePlugin/components/ProjectAutocomplete.vue';\nimport TimesheetCommentModal from '@/orangehrmTimePlugin/components/TimesheetCommentModal.vue';\nimport {OxdAlert, OxdSpinner} from '@ohrm/oxd';\n\nexport default {\n  name: 'Timesheet',\n\n  components: {\n    'oxd-alert': OxdAlert,\n    'oxd-loading-spinner': OxdSpinner,\n    'activity-dropdown': ActivityDropdown,\n    'project-autocomplete': ProjectAutocomplete,\n    'timesheet-comment-modal': TimesheetCommentModal,\n  },\n\n  props: {\n    records: {\n      type: Array,\n      default: () => [],\n    },\n    columns: {\n      type: Object,\n      required: false,\n      default: () => null,\n    },\n    subtotal: {\n      type: String,\n      required: false,\n      default: null,\n    },\n    editable: {\n      type: Boolean,\n      default: false,\n    },\n    loading: {\n      type: Boolean,\n      default: false,\n    },\n    timesheetId: {\n      type: Number,\n      default: null,\n    },\n  },\n\n  emits: ['update:records'],\n\n  data() {\n    return {\n      focusedField: null,\n      showCommentModal: false,\n      commentModalState: null,\n      rules: {\n        project: [\n          validSelection,\n          (v) => v !== null || this.$t('time.select_a_project'),\n        ],\n        activity: [\n          (v) => v !== null || this.$t('time.select_an_activity'),\n          (v) =>\n            this.records.filter((record) => record.activity?.id === v?.id)\n              .length < 2 || this.$t('time.duplicate_record'),\n        ],\n      },\n    };\n  },\n\n  computed: {\n    days() {\n      return this.columns ? Object.keys(this.columns) : [];\n    },\n    dailyTotals() {\n      const totals = {};\n      for (const date in this.columns) {\n        totals[date] = this.records.reduce((acc, record) => {\n          const duration = parseTimeInSeconds(record.dates[date]?.duration);\n          return duration > 0 ? acc + duration : acc;\n        }, 0);\n      }\n      return totals;\n    },\n    daysOfWeek() {\n      const days = [\n        this.$t('general.sun'),\n        this.$t('general.mon'),\n        this.$t('general.tue'),\n        this.$t('general.wed'),\n        this.$t('general.thu'),\n        this.$t('general.fri'),\n        this.$t('general.sat'),\n      ];\n      return this.days.map((day) => {\n        const date = parseDate(day, 'yyyy-MM-dd');\n        return {\n          id: date.valueOf(),\n          day: date.getDate(),\n          title: days[date.getDay()],\n        };\n      });\n    },\n    tableClasses() {\n      return {\n        'orangehrm-timesheet-table': true,\n        '--editable': this.editable,\n      };\n    },\n    fixedColumnClasses() {\n      return {\n        'orangehrm-timesheet-table-header-cell': true,\n        '--freeze-left': !this.editable,\n      };\n    },\n    fixedCellClasses() {\n      return {\n        'orangehrm-timesheet-table-body-cell': true,\n        '--freeze-left': !this.editable,\n      };\n    },\n  },\n\n  methods: {\n    deleteRow(index) {\n      const updated = this.records.filter((_, i) => i !== index);\n      this.syncRecords(updated);\n      this.$nextTick().then(() => {\n        if (updated.length === 0) this.addRow();\n      });\n    },\n    addRow() {\n      const updated = [\n        ...this.records,\n        {\n          project: null,\n          activity: null,\n          dates: {},\n        },\n      ];\n      this.syncRecords(updated);\n    },\n    updateTime($value, index, date) {\n      const updated = this.records.map((record, i) => {\n        if (i === index) {\n          const _date = {\n            [date]: {\n              date: date,\n              duration: $value,\n              id: record.dates[date]?.id,\n              comment: record.dates[date]?.comment,\n            },\n          };\n          record.dates = {...record.dates, ..._date};\n        }\n        return record;\n      });\n      this.syncRecords(updated);\n    },\n    updateComment(id, comment, index, date) {\n      const updated = this.records.map((record, i) => {\n        if (i === index) {\n          const _date = {\n            [date]: {\n              id: id,\n              date: date,\n              comment: comment,\n              duration: record.dates[date]?.duration,\n            },\n          };\n          record.dates = {...record.dates, ..._date};\n        }\n        return record;\n      });\n      this.syncRecords(updated);\n    },\n    updateProject($value, index) {\n      const updated = this.records.map((record, i) => {\n        if (i === index) {\n          record.project = $value ? $value : null;\n          record.customer = $value?._customer ? $value._customer : null;\n        }\n        return record;\n      });\n      this.updateActivity(null, index);\n      this.syncRecords(updated);\n    },\n    updateActivity($value, index) {\n      const updated = this.records.map((record, i) => {\n        if (i === index) {\n          record.activity = $value ? {id: $value.id, name: $value.label} : null;\n        }\n        return record;\n      });\n      this.syncRecords(updated);\n    },\n    syncRecords(updated) {\n      if (!this.editable) return;\n      this.$emit('update:records', updated);\n    },\n    viewComment(record, entry, index, date) {\n      if (record.project?.id && record.activity?.id) {\n        this.commentModalState = {\n          date,\n          index,\n          id: entry?.id,\n          project: record.project,\n          activity: record.activity,\n          customer: record.customer,\n        };\n        this.showCommentModal = true;\n      } else {\n        this.$toast.warn({\n          title: this.$t('general.warning'),\n          message: this.$t('time.select_a_project_and_an_activity'),\n        });\n      }\n    },\n    onCommentModalClose($event) {\n      if ($event) {\n        const {id, comment} = $event;\n        const {index, date} = this.commentModalState;\n        this.updateComment(id, comment, index, date);\n      }\n      this.showCommentModal = false;\n      this.commentModalState = null;\n    },\n    getProject(record) {\n      const {project, customer} = record;\n      if (project && project.label) {\n        return project;\n      }\n      if (project && customer) {\n        return {\n          id: project.id,\n          label: `${customer.name} - ${project.name}`,\n        };\n      }\n      return null;\n    },\n    getActivity(activity) {\n      return activity ? {id: activity.id, label: activity.name} : null;\n    },\n    getDuration(entry) {\n      // TODO: convert to format from user config\n      return entry?.duration ? entry.duration : null;\n    },\n    getCommentIcon(entry) {\n      return entry?.comment ? 'chat-dots-fill' : 'chat-dots';\n    },\n    isCommentVisible(entry, index, date) {\n      if (entry?.comment) return true;\n      if (this.editable) {\n        return (\n          this.focusedField &&\n          this.focusedField.index === index &&\n          this.focusedField.date === date\n        );\n      }\n      return false;\n    },\n    onDurationFocus(index, date) {\n      this.focusedField = {index, date};\n    },\n    onDurationBlur() {\n      this.focusedField = null;\n    },\n    validateDuration(date) {\n      const validateFormat = (v) => {\n        return (\n          v === '' ||\n          v === null ||\n          parseTimeInSeconds(v) >= 0 ||\n          this.$t('time.should_be_less_than_24_and_in_hh_mm_or_decimal_format')\n        );\n      };\n\n      const validateTotal = () => {\n        return this.dailyTotals[date] > 86400\n          ? this.$t('time.total_should_be_less_than_24_hours')\n          : true;\n      };\n\n      return [validateFormat, validateTotal];\n    },\n  },\n};\n</script>\n\n<style src=\"./timesheet.scss\" lang=\"scss\" scoped></style>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}