{"ast":null,"code":"import { computed, ref } from 'vue';\nimport usei18n from '@/core/util/composable/usei18n';\nimport useToast from '@/core/util/composable/useToast';\nimport { APIService } from '@/core/util/services/api.service';\nimport usePaginate from '@ohrm/core/util/composable/usePaginate';\nimport EditTranslationTable from '@/orangehrmAdminPlugin/components/EditTranslationTable.vue';\nimport GroupListDropdown from '@/orangehrmAdminPlugin/components/LanguageGroupListDropdown.vue';\nimport { OxdAlert } from '@ohrm/oxd';\nconst defaultFilters = {\n  sourceText: null,\n  translatedText: null,\n  groupId: null,\n  sortOrder: null,\n  onlyTranslated: null\n};\nexport default {\n  name: 'LanguageTranslationList',\n  components: {\n    'language-group-list-dropdown': GroupListDropdown,\n    'edit-translations': EditTranslationTable,\n    'oxd-alert': OxdAlert\n  },\n  props: {\n    languageId: {\n      type: Number,\n      required: true\n    },\n    languagePackage: {\n      type: String,\n      required: true\n    },\n    sourceLanguage: {\n      type: String,\n      required: true\n    }\n  },\n  setup(props) {\n    const {\n      $t\n    } = usei18n();\n    const {\n      saveSuccess\n    } = useToast();\n    const translationOptions = ref([{\n      id: 1,\n      label: $t('admin.all'),\n      value: null\n    }, {\n      id: 2,\n      label: $t('admin.translated'),\n      value: true\n    }, {\n      id: 3,\n      label: $t('admin.not_translated'),\n      value: false\n    }]);\n    const sortOptions = ref([{\n      id: 'ASC',\n      label: $t('general.ascending')\n    }, {\n      id: 'DESC',\n      label: $t('general.descending')\n    }]);\n    const filters = ref({\n      ...defaultFilters,\n      sortOrder: sortOptions.value[0],\n      onlyTranslated: translationOptions.value[0]\n    });\n    const serializedFilters = computed(() => {\n      return {\n        sourceText: filters.value.sourceText,\n        translatedText: filters.value.translatedText,\n        groupId: filters.value.groupId?.id,\n        sortOrder: filters.value.sortOrder?.id,\n        onlyTranslated: filters.value.onlyTranslated?.value\n      };\n    });\n    const http = new APIService(window.appGlobal.baseUrl, `/api/v2/admin/i18n/languages/${props.languageId}/translations`);\n    const {\n      showPaginator,\n      currentPage,\n      total,\n      pages,\n      response: items,\n      isLoading,\n      execQuery\n    } = usePaginate(http, {\n      query: serializedFilters\n    });\n    const itemsModified = ref(false);\n    const onReset = () => {\n      currentPage.value = 1;\n      itemsModified.value = false;\n      filters.value = {\n        ...defaultFilters,\n        sortOrder: sortOptions.value[0]\n      };\n      execQuery();\n    };\n    const onSubmit = () => {\n      itemsModified.value = false;\n      execQuery();\n    };\n    const checkItemsModified = () => {\n      itemsModified.value = items.value.data.reduce((accumulator, item) => accumulator || item.target !== null && item.oldTarget !== item.target && item.modified === true, false);\n    };\n    const onSubmitLangString = () => {\n      isLoading.value = true;\n      http.request({\n        method: `PUT`,\n        url: `/api/v2/admin/i18n/languages/${props.languageId}/translations/bulk`,\n        data: {\n          data: items.value.data.filter(item => item.target !== null && item.modified === true).map(item => {\n            return {\n              langStringId: item.langStringId,\n              translatedValue: item.target\n            };\n          })\n        }\n      }).then(() => {\n        return saveSuccess();\n      }).then(() => {\n        itemsModified.value = false;\n        execQuery();\n      });\n    };\n    return {\n      showPaginator,\n      currentPage,\n      isLoading,\n      total,\n      pages,\n      items,\n      filters,\n      translationOptions,\n      sortOptions,\n      onReset,\n      onSubmit,\n      onSubmitLangString,\n      itemsModified,\n      checkItemsModified\n    };\n  }\n};","map":{"version":3,"mappings":"AAgJA,SAAQA,QAAQ,EAAEC,GAAG,QAAO,KAAK;AACjC,OAAOC,OAAM,MAAO,gCAAgC;AACpD,OAAOC,QAAO,MAAO,iCAAiC;AACtD,SAAQC,UAAU,QAAO,kCAAkC;AAC3D,OAAOC,WAAU,MAAO,wCAAwC;AAChE,OAAOC,oBAAmB,MAAO,4DAA4D;AAC7F,OAAOC,iBAAgB,MAAO,iEAAiE;AAC/F,SAAQC,QAAQ,QAAO,WAAW;AAElC,MAAMC,cAAa,GAAI;EACrBC,UAAU,EAAE,IAAI;EAChBC,cAAc,EAAE,IAAI;EACpBC,OAAO,EAAE,IAAI;EACbC,SAAS,EAAE,IAAI;EACfC,cAAc,EAAE;AAClB,CAAC;AAED,eAAe;EACbC,IAAI,EAAE,yBAAyB;EAC/BC,UAAU,EAAE;IACV,8BAA8B,EAAET,iBAAiB;IACjD,mBAAmB,EAAED,oBAAoB;IACzC,WAAW,EAAEE;EACf,CAAC;EACDS,KAAK,EAAE;IACLC,UAAU,EAAE;MACVC,IAAI,EAAEC,MAAM;MACZC,QAAQ,EAAE;IACZ,CAAC;IACDC,eAAe,EAAE;MACfH,IAAI,EAAEI,MAAM;MACZF,QAAQ,EAAE;IACZ,CAAC;IACDG,cAAc,EAAE;MACdL,IAAI,EAAEI,MAAM;MACZF,QAAQ,EAAE;IACZ;EACF,CAAC;EAEDI,KAAK,CAACR,KAAK,EAAE;IACX,MAAM;MAACS;IAAE,IAAIxB,OAAO,EAAE;IAEtB,MAAM;MAACyB;IAAW,IAAIxB,QAAQ,EAAE;IAEhC,MAAMyB,kBAAiB,GAAI3B,GAAG,CAAC,CAC7B;MAAC4B,EAAE,EAAE,CAAC;MAAEC,KAAK,EAAEJ,EAAE,CAAC,WAAW,CAAC;MAAEK,KAAK,EAAE;IAAI,CAAC,EAC5C;MAACF,EAAE,EAAE,CAAC;MAAEC,KAAK,EAAEJ,EAAE,CAAC,kBAAkB,CAAC;MAAEK,KAAK,EAAE;IAAI,CAAC,EACnD;MAACF,EAAE,EAAE,CAAC;MAAEC,KAAK,EAAEJ,EAAE,CAAC,sBAAsB,CAAC;MAAEK,KAAK,EAAE;IAAK,CAAC,CACzD,CAAC;IAEF,MAAMC,WAAU,GAAI/B,GAAG,CAAC,CACtB;MAAC4B,EAAE,EAAE,KAAK;MAAEC,KAAK,EAAEJ,EAAE,CAAC,mBAAmB;IAAC,CAAC,EAC3C;MAACG,EAAE,EAAE,MAAM;MAAEC,KAAK,EAAEJ,EAAE,CAAC,oBAAoB;IAAC,CAAC,CAC9C,CAAC;IAEF,MAAMO,OAAM,GAAIhC,GAAG,CAAC;MAClB,GAAGQ,cAAc;MACjBI,SAAS,EAAEmB,WAAW,CAACD,KAAK,CAAC,CAAC,CAAC;MAC/BjB,cAAc,EAAEc,kBAAkB,CAACG,KAAK,CAAC,CAAC;IAC5C,CAAC,CAAC;IAEF,MAAMG,iBAAgB,GAAIlC,QAAQ,CAAC,MAAM;MACvC,OAAO;QACLU,UAAU,EAAEuB,OAAO,CAACF,KAAK,CAACrB,UAAU;QACpCC,cAAc,EAAEsB,OAAO,CAACF,KAAK,CAACpB,cAAc;QAC5CC,OAAO,EAAEqB,OAAO,CAACF,KAAK,CAACnB,OAAO,EAAEiB,EAAE;QAClChB,SAAS,EAAEoB,OAAO,CAACF,KAAK,CAAClB,SAAS,EAAEgB,EAAE;QACtCf,cAAc,EAAEmB,OAAO,CAACF,KAAK,CAACjB,cAAc,EAAEiB;MAChD,CAAC;IACH,CAAC,CAAC;IAEF,MAAMI,IAAG,GAAI,IAAI/B,UAAU,CACzBgC,MAAM,CAACC,SAAS,CAACC,OAAO,EACvB,gCAA+BrB,KAAK,CAACC,UAAW,eAAc,CAChE;IAED,MAAM;MACJqB,aAAa;MACbC,WAAW;MACXC,KAAK;MACLC,KAAK;MACLC,QAAQ,EAAEC,KAAK;MACfC,SAAS;MACTC;IACF,IAAIzC,WAAW,CAAC8B,IAAI,EAAE;MAACY,KAAK,EAAEb;IAAiB,CAAC,CAAC;IAEjD,MAAMc,aAAY,GAAI/C,GAAG,CAAC,KAAK,CAAC;IAEhC,MAAMgD,OAAM,GAAI,MAAM;MACpBT,WAAW,CAACT,KAAI,GAAI,CAAC;MACrBiB,aAAa,CAACjB,KAAI,GAAI,KAAK;MAC3BE,OAAO,CAACF,KAAI,GAAI;QAAC,GAAGtB,cAAc;QAAEI,SAAS,EAAEmB,WAAW,CAACD,KAAK,CAAC,CAAC;MAAC,CAAC;MACpEe,SAAS,EAAE;IACb,CAAC;IAED,MAAMI,QAAO,GAAI,MAAM;MACrBF,aAAa,CAACjB,KAAI,GAAI,KAAK;MAC3Be,SAAS,EAAE;IACb,CAAC;IAED,MAAMK,kBAAiB,GAAI,MAAM;MAC/BH,aAAa,CAACjB,KAAI,GAAIa,KAAK,CAACb,KAAK,CAACqB,IAAI,CAACC,MAAM,CAC3C,CAACC,WAAW,EAAEC,IAAI,KAChBD,WAAU,IACTC,IAAI,CAACC,MAAK,KAAM,IAAG,IAClBD,IAAI,CAACE,SAAQ,KAAMF,IAAI,CAACC,MAAK,IAC7BD,IAAI,CAACG,QAAO,KAAM,IAAK,EAC3B,KAAK,CACN;IACH,CAAC;IAED,MAAMC,kBAAiB,GAAI,MAAM;MAC/Bd,SAAS,CAACd,KAAI,GAAI,IAAI;MACtBI,IAAG,CACAyB,OAAO,CAAC;QACPC,MAAM,EAAG,KAAI;QACbC,GAAG,EAAG,gCAA+B7C,KAAK,CAACC,UAAW,oBAAmB;QACzEkC,IAAI,EAAE;UACJA,IAAI,EAAER,KAAK,CAACb,KAAK,CAACqB,IAAG,CAClBW,MAAM,CAAER,IAAI,IAAKA,IAAI,CAACC,MAAK,KAAM,IAAG,IAAKD,IAAI,CAACG,QAAO,KAAM,IAAI,EAC/DM,GAAG,CAAET,IAAI,IAAK;YACb,OAAO;cACLU,YAAY,EAAEV,IAAI,CAACU,YAAY;cAC/BC,eAAe,EAAEX,IAAI,CAACC;YACxB,CAAC;UACH,CAAC;QACL;MACF,CAAC,EACAW,IAAI,CAAC,MAAM;QACV,OAAOxC,WAAW,EAAE;MACtB,CAAC,EACAwC,IAAI,CAAC,MAAM;QACVnB,aAAa,CAACjB,KAAI,GAAI,KAAK;QAC3Be,SAAS,EAAE;MACb,CAAC,CAAC;IACN,CAAC;IAED,OAAO;MACLP,aAAa;MACbC,WAAW;MACXK,SAAS;MACTJ,KAAK;MACLC,KAAK;MACLE,KAAK;MACLX,OAAO;MACPL,kBAAkB;MAClBI,WAAW;MACXiB,OAAO;MACPC,QAAQ;MACRS,kBAAkB;MAClBX,aAAa;MACbG;IACF,CAAC;EACH;AACF,CAAC","names":["computed","ref","usei18n","useToast","APIService","usePaginate","EditTranslationTable","GroupListDropdown","OxdAlert","defaultFilters","sourceText","translatedText","groupId","sortOrder","onlyTranslated","name","components","props","languageId","type","Number","required","languagePackage","String","sourceLanguage","setup","$t","saveSuccess","translationOptions","id","label","value","sortOptions","filters","serializedFilters","http","window","appGlobal","baseUrl","showPaginator","currentPage","total","pages","response","items","isLoading","execQuery","query","itemsModified","onReset","onSubmit","checkItemsModified","data","reduce","accumulator","item","target","oldTarget","modified","onSubmitLangString","request","method","url","filter","map","langStringId","translatedValue","then"],"sourceRoot":"","sources":["C:\\xampp\\htdocs\\orangehrm-5.7\\src\\client\\src\\orangehrmAdminPlugin\\pages\\languageTranslation\\languageTranslation.vue"],"sourcesContent":["<!--\n/**\n * OrangeHRM is a comprehensive Human Resource Management (HRM) System that captures\n * all the essential functionalities required for any enterprise.\n * Copyright (C) 2006 OrangeHRM Inc., http://www.orangehrm.com\n *\n * OrangeHRM is free software: you can redistribute it and/or modify it under the terms of\n * the GNU General Public License as published by the Free Software Foundation, either\n * version 3 of the License, or (at your option) any later version.\n *\n * OrangeHRM is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;\n * without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n * See the GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License along with OrangeHRM.\n * If not, see <https://www.gnu.org/licenses/>.\n */\n -->\n\n<template>\n  <div class=\"orangehrm-background-container\">\n    <oxd-table-filter :filter-title=\"$t('admin.translate_language_package')\">\n      <oxd-form @submit-valid=\"onSubmit\" @reset=\"onReset\">\n        <oxd-form-row>\n          <oxd-grid :cols=\"3\" class=\"orangehrm-full-width-grid\">\n            <oxd-grid-item>\n              <oxd-input-field\n                :value=\"languagePackage\"\n                :label=\"$t('admin.language_package')\"\n                disabled\n              />\n            </oxd-grid-item>\n            <oxd-grid-item>\n              <oxd-input-field\n                :value=\"sourceLanguage\"\n                :label=\"$t('admin.source_language')\"\n                disabled\n              />\n            </oxd-grid-item>\n          </oxd-grid>\n          <oxd-grid :cols=\"3\" class=\"orangehrm-full-width-grid\">\n            <oxd-grid-item>\n              <language-group-list-dropdown v-model=\"filters.groupId\" />\n            </oxd-grid-item>\n            <oxd-grid-item>\n              <oxd-input-field\n                v-model=\"filters.sourceText\"\n                :label=\"$t('admin.source_text')\"\n              />\n            </oxd-grid-item>\n            <oxd-grid-item>\n              <oxd-input-field\n                v-model=\"filters.translatedText\"\n                :label=\"$t('admin.translated_text')\"\n              />\n            </oxd-grid-item>\n            <oxd-grid-item>\n              <oxd-input-field\n                v-model=\"filters.onlyTranslated\"\n                type=\"select\"\n                :label=\"$t('admin.show')\"\n                :options=\"translationOptions\"\n              />\n            </oxd-grid-item>\n            <oxd-grid-item>\n              <oxd-input-field\n                v-model=\"filters.sortOrder\"\n                type=\"select\"\n                :label=\"$t('admin.order')\"\n                :options=\"sortOptions\"\n              />\n            </oxd-grid-item>\n          </oxd-grid>\n        </oxd-form-row>\n        <oxd-divider />\n        <oxd-form-actions>\n          <oxd-button\n            display-type=\"ghost\"\n            :label=\"$t('general.reset')\"\n            type=\"reset\"\n          />\n          <oxd-button\n            class=\"orangehrm-left-space\"\n            display-type=\"secondary\"\n            :label=\"$t('general.search')\"\n            type=\"submit\"\n          />\n        </oxd-form-actions>\n      </oxd-form>\n    </oxd-table-filter>\n    <br />\n    <oxd-alert\n      :show=\"!isLoading && itemsModified\"\n      type=\"info\"\n      :message=\"$t('admin.please_save_before_pagination')\"\n    ></oxd-alert>\n    <div class=\"orangehrm-paper-container\">\n      <oxd-form\n        v-if=\"total > 0\"\n        :loading=\"isLoading\"\n        @submit-valid=\"onSubmitLangString\"\n        @reset=\"onReset\"\n      >\n        <div class=\"orangehrm-header-container\">\n          <oxd-pagination\n            v-if=\"showPaginator && !itemsModified\"\n            :key=\"currentPage\"\n            v-model:current=\"currentPage\"\n            :length=\"pages\"\n          />\n        </div>\n        <table-header\n          :loading=\"isLoading\"\n          :total=\"total\"\n          :selected=\"0\"\n        ></table-header>\n        <edit-translations\n          v-if=\"items?.data\"\n          v-model:langstrings=\"items.data\"\n          @update:langstrings=\"checkItemsModified\"\n        ></edit-translations>\n        <oxd-form-actions>\n          <div class=\"orangehrm-bottom-container\">\n            <div>\n              <oxd-button\n                display-type=\"ghost\"\n                :label=\"$t('general.cancel')\"\n                type=\"reset\"\n              />\n              <oxd-button\n                class=\"orangehrm-left-space\"\n                display-type=\"secondary\"\n                :label=\"$t('general.save')\"\n                type=\"submit\"\n              />\n            </div>\n          </div>\n        </oxd-form-actions>\n      </oxd-form>\n    </div>\n  </div>\n</template>\n\n<script>\nimport {computed, ref} from 'vue';\nimport usei18n from '@/core/util/composable/usei18n';\nimport useToast from '@/core/util/composable/useToast';\nimport {APIService} from '@/core/util/services/api.service';\nimport usePaginate from '@ohrm/core/util/composable/usePaginate';\nimport EditTranslationTable from '@/orangehrmAdminPlugin/components/EditTranslationTable.vue';\nimport GroupListDropdown from '@/orangehrmAdminPlugin/components/LanguageGroupListDropdown.vue';\nimport {OxdAlert} from '@ohrm/oxd';\n\nconst defaultFilters = {\n  sourceText: null,\n  translatedText: null,\n  groupId: null,\n  sortOrder: null,\n  onlyTranslated: null,\n};\n\nexport default {\n  name: 'LanguageTranslationList',\n  components: {\n    'language-group-list-dropdown': GroupListDropdown,\n    'edit-translations': EditTranslationTable,\n    'oxd-alert': OxdAlert,\n  },\n  props: {\n    languageId: {\n      type: Number,\n      required: true,\n    },\n    languagePackage: {\n      type: String,\n      required: true,\n    },\n    sourceLanguage: {\n      type: String,\n      required: true,\n    },\n  },\n\n  setup(props) {\n    const {$t} = usei18n();\n\n    const {saveSuccess} = useToast();\n\n    const translationOptions = ref([\n      {id: 1, label: $t('admin.all'), value: null},\n      {id: 2, label: $t('admin.translated'), value: true},\n      {id: 3, label: $t('admin.not_translated'), value: false},\n    ]);\n\n    const sortOptions = ref([\n      {id: 'ASC', label: $t('general.ascending')},\n      {id: 'DESC', label: $t('general.descending')},\n    ]);\n\n    const filters = ref({\n      ...defaultFilters,\n      sortOrder: sortOptions.value[0],\n      onlyTranslated: translationOptions.value[0],\n    });\n\n    const serializedFilters = computed(() => {\n      return {\n        sourceText: filters.value.sourceText,\n        translatedText: filters.value.translatedText,\n        groupId: filters.value.groupId?.id,\n        sortOrder: filters.value.sortOrder?.id,\n        onlyTranslated: filters.value.onlyTranslated?.value,\n      };\n    });\n\n    const http = new APIService(\n      window.appGlobal.baseUrl,\n      `/api/v2/admin/i18n/languages/${props.languageId}/translations`,\n    );\n\n    const {\n      showPaginator,\n      currentPage,\n      total,\n      pages,\n      response: items,\n      isLoading,\n      execQuery,\n    } = usePaginate(http, {query: serializedFilters});\n\n    const itemsModified = ref(false);\n\n    const onReset = () => {\n      currentPage.value = 1;\n      itemsModified.value = false;\n      filters.value = {...defaultFilters, sortOrder: sortOptions.value[0]};\n      execQuery();\n    };\n\n    const onSubmit = () => {\n      itemsModified.value = false;\n      execQuery();\n    };\n\n    const checkItemsModified = () => {\n      itemsModified.value = items.value.data.reduce(\n        (accumulator, item) =>\n          accumulator ||\n          (item.target !== null &&\n            item.oldTarget !== item.target &&\n            item.modified === true),\n        false,\n      );\n    };\n\n    const onSubmitLangString = () => {\n      isLoading.value = true;\n      http\n        .request({\n          method: `PUT`,\n          url: `/api/v2/admin/i18n/languages/${props.languageId}/translations/bulk`,\n          data: {\n            data: items.value.data\n              .filter((item) => item.target !== null && item.modified === true)\n              .map((item) => {\n                return {\n                  langStringId: item.langStringId,\n                  translatedValue: item.target,\n                };\n              }),\n          },\n        })\n        .then(() => {\n          return saveSuccess();\n        })\n        .then(() => {\n          itemsModified.value = false;\n          execQuery();\n        });\n    };\n\n    return {\n      showPaginator,\n      currentPage,\n      isLoading,\n      total,\n      pages,\n      items,\n      filters,\n      translationOptions,\n      sortOptions,\n      onReset,\n      onSubmit,\n      onSubmitLangString,\n      itemsModified,\n      checkItemsModified,\n    };\n  },\n};\n</script>\n<style lang=\"scss\" scoped>\n.orangehrm-header-container {\n  justify-content: end;\n}\n</style>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}