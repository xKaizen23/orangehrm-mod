{"ast":null,"code":"import { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, openBlock as _openBlock, createBlock as _createBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-58bcc29e\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"orangehrm-attendance-card\"\n};\nconst _hoisted_2 = {\n  class: \"orangehrm-attendance-card-profile\"\n};\nconst _hoisted_3 = {\n  class: \"orangehrm-attendance-card-profile-image\"\n};\nconst _hoisted_4 = [\"src\"];\nconst _hoisted_5 = {\n  class: \"orangehrm-attendance-card-profile-record\"\n};\nconst _hoisted_6 = {\n  class: \"orangehrm-attendance-card-bar\"\n};\nconst _hoisted_7 = {\n  class: \"orangehrm-attendance-card-summary\"\n};\nconst _hoisted_8 = {\n  class: \"orangehrm-attendance-card-summary-week\"\n};\nconst _hoisted_9 = {\n  class: \"orangehrm-attendance-card-summary-total\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_oxd_text = _resolveComponent(\"oxd-text\");\n  const _component_oxd_icon_button = _resolveComponent(\"oxd-icon-button\");\n  const _component_oxd_divider = _resolveComponent(\"oxd-divider\");\n  const _component_oxd_icon = _resolveComponent(\"oxd-icon\");\n  const _component_oxd_bar_chart = _resolveComponent(\"oxd-bar-chart\");\n  const _component_base_widget = _resolveComponent(\"base-widget\");\n  return _openBlock(), _createBlock(_component_base_widget, {\n    icon: \"clock-fill\",\n    loading: $data.isLoading,\n    title: _ctx.$t('dashboard.time_at_work')\n  }, {\n    default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"img\", {\n      alt: \"profile picture\",\n      class: \"employee-image\",\n      src: `../pim/viewPhoto/empNumber/${$data.empNumber}`\n    }, null, 8, _hoisted_4)]), _createElementVNode(\"div\", _hoisted_5, [_createVNode(_component_oxd_text, {\n      tag: \"p\",\n      class: \"orangehrm-attendance-card-state\"\n    }, {\n      default: _withCtx(() => [_createTextVNode(_toDisplayString($options.lastState), 1)]),\n      _: 1\n    }), _createVNode(_component_oxd_text, {\n      tag: \"p\",\n      class: \"orangehrm-attendance-card-details\"\n    }, {\n      default: _withCtx(() => [_createTextVNode(_toDisplayString($options.lastRecord), 1)]),\n      _: 1\n    })])]), _createElementVNode(\"div\", _hoisted_6, [_createVNode(_component_oxd_text, {\n      tag: \"span\",\n      class: \"orangehrm-attendance-card-fulltime\"\n    }, {\n      default: _withCtx(() => [_createElementVNode(\"b\", null, _toDisplayString($data.dayTotal.hours) + \"h\", 1), _createTextVNode(), _createElementVNode(\"b\", null, _toDisplayString($data.dayTotal.minutes) + \"m\", 1), _createTextVNode(\" \" + _toDisplayString(_ctx.$t('general.today')), 1)]),\n      _: 1\n    }), _createVNode(_component_oxd_icon_button, {\n      name: \"stopwatch\",\n      \"display-type\": \"solid-main\",\n      class: \"orangehrm-attendance-card-action\",\n      onClick: $options.onClickPunchIn\n    }, null, 8, [\"onClick\"])]), _createVNode(_component_oxd_divider), _createElementVNode(\"div\", _hoisted_7, [_createElementVNode(\"div\", _hoisted_8, [_createVNode(_component_oxd_text, {\n      tag: \"p\"\n    }, {\n      default: _withCtx(() => [_createTextVNode(_toDisplayString(_ctx.$t('dashboard.this_week')), 1)]),\n      _: 1\n    }), _createVNode(_component_oxd_text, {\n      tag: \"p\"\n    }, {\n      default: _withCtx(() => [_createTextVNode(_toDisplayString($options.currentWeek), 1)]),\n      _: 1\n    })]), _createElementVNode(\"div\", _hoisted_9, [_createVNode(_component_oxd_icon, {\n      name: \"stopwatch\",\n      class: \"orangehrm-attendance-card-icon\"\n    }), _createVNode(_component_oxd_text, {\n      tag: \"p\",\n      class: \"orangehrm-attendance-card-fulltime\"\n    }, {\n      default: _withCtx(() => [_createTextVNode(_toDisplayString($data.weekTotal.hours) + \"h \" + _toDisplayString($data.weekTotal.minutes) + \"m \", 1)]),\n      _: 1\n    })])])]), _createVNode(_component_oxd_bar_chart, {\n      grid: false,\n      data: $data.dataset,\n      \"y-axsis\": false,\n      \"aspect-ratio\": false,\n      \"wrapper-classes\": \"emp-attendance-chart\"\n    }, null, 8, [\"data\"])]),\n    _: 1\n  }, 8, [\"loading\", \"title\"]);\n}","map":{"version":3,"mappings":";;;EAyBSA,KAAK,EAAC;AAA2B;;EAC/BA,KAAK,EAAC;AAAmC;;EACvCA,KAAK,EAAC;AAAyC;;;EAO/CA,KAAK,EAAC;AAA0C;;EASlDA,KAAK,EAAC;AAA+B;;EAarCA,KAAK,EAAC;AAAmC;;EACvCA,KAAK,EAAC;AAAwC;;EAQ9CA,KAAK,EAAC;AAAyC;;;;;;;;uBA7C1DC,aA4DcC;IA3DZC,IAAI,EAAC,YAAY;IAChBC,OAAO,EAAEC,eAAS;IAClBC,KAAK,EAAEC,OAAE;;sBAEV,MA+CM,CA/CNC,oBA+CM,OA/CNC,UA+CM,GA9CJD,oBAgBM,OAhBNE,UAgBM,GAfJF,oBAMM,OANNG,UAMM,GALJH,oBAIE;MAHAI,GAAG,EAAC,iBAAiB;MACrBZ,KAAK,EAAC,gBAAgB;MACrBa,GAAG,gCAAgCR,eAAS;+BAGjDG,oBAOM,OAPNM,UAOM,GANJC,aAEWC;MAFDC,GAAG,EAAC,GAAG;MAACjB,KAAK,EAAC;;wBACtB,MAAe,mCAAZkB,kBAAS;;QAEdH,aAEWC;MAFDC,GAAG,EAAC,GAAG;MAACjB,KAAK,EAAC;;wBACtB,MAAgB,mCAAbkB,mBAAU;;YAInBV,oBAWM,OAXNW,UAWM,GAVJJ,aAGWC;MAHDC,GAAG,EAAC,MAAM;MAACjB,KAAK,EAAC;;wBACzB,MAA4B,CAA5BQ,oBAA4B,4BAAtBH,cAAQ,CAACe,KAAK,IAAG,GAAC,0BAAKZ,oBAA8B,4BAAxBH,cAAQ,CAACgB,OAAO,IAAG,GAAC,uBAAI,GAC3D,oBAAGd,OAAE;;QAEPQ,aAKEO;MAJAC,IAAI,EAAC,WAAW;MAChB,cAAY,EAAC,YAAY;MACzBvB,KAAK,EAAC,kCAAkC;MACvCwB,OAAK,EAAEN;gCAGZH,aAAeU,yBACfjB,oBAeM,OAfNkB,UAeM,GAdJlB,oBAOM,OAPNmB,UAOM,GANJZ,aAEWC;MAFDC,GAAG,EAAC;IAAG;wBACf,MAA+B,mCAA5BV,OAAE;;QAEPQ,aAEWC;MAFDC,GAAG,EAAC;IAAG;wBACf,MAAiB,mCAAdC,oBAAW;;UAGlBV,oBAKM,OALNoB,UAKM,GAJJb,aAAoEc;MAA1DN,IAAI,EAAC,WAAW;MAACvB,KAAK,EAAC;QACjCe,aAEWC;MAFDC,GAAG,EAAC,GAAG;MAACjB,KAAK,EAAC;;wBACtB,MAAqB,mCAAlBK,eAAS,CAACe,KAAK,IAAG,IAAE,oBAAGf,eAAS,CAACgB,OAAO,IAAG,IAChD;;cAINN,aAMiBe;MALdC,IAAI,EAAE,KAAK;MACXC,IAAI,EAAE3B,aAAO;MACb,SAAO,EAAE,KAAK;MACd,cAAY,EAAE,KAAK;MACpB,iBAAe,EAAC","names":["class","_createBlock","_component_base_widget","icon","loading","$data","title","_ctx","_createElementVNode","_hoisted_1","_hoisted_2","_hoisted_3","alt","src","_hoisted_5","_createVNode","_component_oxd_text","tag","$options","_hoisted_6","hours","minutes","_component_oxd_icon_button","name","onClick","_component_oxd_divider","_hoisted_7","_hoisted_8","_hoisted_9","_component_oxd_icon","_component_oxd_bar_chart","grid","data"],"sourceRoot":"","sources":["C:\\xampp\\htdocs\\orangehrm-5.7\\src\\client\\src\\orangehrmDashboardPlugin\\components\\EmployeeAttendanceWidget.vue"],"sourcesContent":["<!--\n/**\n * OrangeHRM is a comprehensive Human Resource Management (HRM) System that captures\n * all the essential functionalities required for any enterprise.\n * Copyright (C) 2006 OrangeHRM Inc., http://www.orangehrm.com\n *\n * OrangeHRM is free software: you can redistribute it and/or modify it under the terms of\n * the GNU General Public License as published by the Free Software Foundation, either\n * version 3 of the License, or (at your option) any later version.\n *\n * OrangeHRM is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;\n * without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n * See the GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License along with OrangeHRM.\n * If not, see <https://www.gnu.org/licenses/>.\n */\n -->\n\n<template>\n  <base-widget\n    icon=\"clock-fill\"\n    :loading=\"isLoading\"\n    :title=\"$t('dashboard.time_at_work')\"\n  >\n    <div class=\"orangehrm-attendance-card\">\n      <div class=\"orangehrm-attendance-card-profile\">\n        <div class=\"orangehrm-attendance-card-profile-image\">\n          <img\n            alt=\"profile picture\"\n            class=\"employee-image\"\n            :src=\"`../pim/viewPhoto/empNumber/${empNumber}`\"\n          />\n        </div>\n        <div class=\"orangehrm-attendance-card-profile-record\">\n          <oxd-text tag=\"p\" class=\"orangehrm-attendance-card-state\">\n            {{ lastState }}\n          </oxd-text>\n          <oxd-text tag=\"p\" class=\"orangehrm-attendance-card-details\">\n            {{ lastRecord }}\n          </oxd-text>\n        </div>\n      </div>\n      <div class=\"orangehrm-attendance-card-bar\">\n        <oxd-text tag=\"span\" class=\"orangehrm-attendance-card-fulltime\">\n          <b>{{ dayTotal.hours }}h</b> <b>{{ dayTotal.minutes }}m</b>\n          {{ $t('general.today') }}\n        </oxd-text>\n        <oxd-icon-button\n          name=\"stopwatch\"\n          display-type=\"solid-main\"\n          class=\"orangehrm-attendance-card-action\"\n          @click=\"onClickPunchIn\"\n        />\n      </div>\n      <oxd-divider />\n      <div class=\"orangehrm-attendance-card-summary\">\n        <div class=\"orangehrm-attendance-card-summary-week\">\n          <oxd-text tag=\"p\">\n            {{ $t('dashboard.this_week') }}\n          </oxd-text>\n          <oxd-text tag=\"p\">\n            {{ currentWeek }}\n          </oxd-text>\n        </div>\n        <div class=\"orangehrm-attendance-card-summary-total\">\n          <oxd-icon name=\"stopwatch\" class=\"orangehrm-attendance-card-icon\" />\n          <oxd-text tag=\"p\" class=\"orangehrm-attendance-card-fulltime\">\n            {{ weekTotal.hours }}h {{ weekTotal.minutes }}m\n          </oxd-text>\n        </div>\n      </div>\n    </div>\n    <oxd-bar-chart\n      :grid=\"false\"\n      :data=\"dataset\"\n      :y-axsis=\"false\"\n      :aspect-ratio=\"false\"\n      wrapper-classes=\"emp-attendance-chart\"\n    ></oxd-bar-chart>\n  </base-widget>\n</template>\n\n<script>\nimport {\n  isToday,\n  freshDate,\n  parseDate,\n  formatDate,\n} from '@/core/util/helper/datefns';\nimport {navigate} from '@/core/util/helper/navigation';\nimport useLocale from '@/core/util/composable/useLocale';\nimport {APIService} from '@/core/util/services/api.service';\nimport BaseWidget from '@/orangehrmDashboardPlugin/components/BaseWidget.vue';\nimport {OxdBarChart, OxdIcon, CHART_COLORS} from '@ohrm/oxd';\n\nexport default {\n  name: 'EmployeeAttendanceWidget',\n\n  components: {\n    'oxd-icon': OxdIcon,\n    'base-widget': BaseWidget,\n    'oxd-bar-chart': OxdBarChart,\n  },\n\n  setup() {\n    const {locale} = useLocale();\n    const http = new APIService(\n      window.appGlobal.baseUrl,\n      '/api/v2/dashboard/employees/time-at-work',\n    );\n\n    return {\n      http,\n      locale,\n    };\n  },\n\n  data() {\n    return {\n      dataset: [],\n      state: null,\n      endDate: null,\n      userDate: null,\n      userTime: null,\n      startDate: null,\n      isLoading: false,\n      empNumber: null,\n      timezoneOffset: null,\n      dayTotal: {\n        hours: 0,\n        minutes: 0,\n      },\n      weekTotal: {\n        hours: 0,\n        minutes: 0,\n      },\n    };\n  },\n\n  computed: {\n    lastState() {\n      switch (this.state) {\n        case 'PUNCHED IN':\n          return this.$t('attendance.punched_in');\n        case 'PUNCHED OUT':\n          return this.$t('attendance.punched_out');\n        default:\n          return this.$t('attendance.not_punched_in');\n      }\n    },\n    lastRecord() {\n      if (!this.userDate || !this.userTime) return null;\n      const parsedDate = parseDate(\n        `${this.userDate} ${this.userTime}`,\n        'yyyy-MM-dd HH:mm',\n      );\n      const formattedTime = formatDate(parsedDate, 'hh:mm a', {\n        locale: this.locale,\n      });\n\n      if (!isToday(parsedDate)) {\n        const formattedDate = formatDate(parsedDate, 'MMM do', {\n          locale: this.locale,\n        });\n        return this.$t('dashboard.state_date_at_time_timezone_offset', {\n          lastState: this.lastState,\n          date: formattedDate,\n          time: formattedTime,\n          timezoneOffset: this.timezoneOffset,\n        });\n      }\n\n      return this.$t('dashboard.state_today_at_time_timezone_offset', {\n        lastState: this.lastState,\n        time: formattedTime,\n        timezoneOffset: this.timezoneOffset,\n      });\n    },\n    currentWeek() {\n      if (!this.startDate || !this.endDate) return null;\n      const startDate = formatDate(parseDate(this.startDate), 'MMM dd', {\n        locale: this.locale,\n      });\n      const endDate = formatDate(parseDate(this.endDate), 'MMM dd', {\n        locale: this.locale,\n      });\n      return `${startDate} - ${endDate}`;\n    },\n  },\n\n  beforeMount() {\n    this.fetchWidgetData();\n  },\n\n  methods: {\n    onClickPunchIn() {\n      navigate('/attendance/punchIn');\n    },\n    fetchWidgetData() {\n      this.isLoading = true;\n      const currentDate = freshDate();\n      const timezoneOffset = (currentDate.getTimezoneOffset() / 60) * -1;\n      this.http\n        .getAll({\n          timezoneOffset,\n          currentDate: formatDate(currentDate, 'yyyy-MM-dd'),\n          currentTime: formatDate(new Date(), 'HH:mm'),\n        })\n        .then((response) => {\n          const {data, meta} = response.data;\n          this.dataset = data.map((item) => ({\n            value: item.totalTime.hours + item.totalTime.minutes / 60,\n            label: this.$t(\n              `general.${new String(item.workDay.day).toLowerCase()}`,\n            ),\n            color: CHART_COLORS.COLOR_HEAT_WAVE,\n          }));\n\n          const {lastAction, currentDay, currentWeek, currentUser} = meta;\n          if (lastAction) {\n            this.state = lastAction.state;\n            this.userDate = lastAction.userDate;\n            this.userTime = lastAction.userTime;\n            this.timezoneOffset = lastAction.timezoneOffset;\n          }\n          if (currentWeek) {\n            this.weekTotal = currentWeek.totalTime;\n            this.endDate = currentWeek.endDate?.date;\n            this.startDate = currentWeek.startDate?.date;\n          }\n          if (currentDay) {\n            this.dayTotal = currentDay.totalTime;\n          }\n          if (currentUser) {\n            this.empNumber = currentUser.empNumber;\n          }\n        })\n        .finally(() => {\n          this.isLoading = false;\n        });\n    },\n  },\n};\n</script>\n\n<style src=\"./employee-attendance-widget.scss\" lang=\"scss\" scoped></style>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}