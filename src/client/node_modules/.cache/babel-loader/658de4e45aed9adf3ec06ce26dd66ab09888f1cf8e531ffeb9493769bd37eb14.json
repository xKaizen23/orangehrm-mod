{"ast":null,"code":"import { computed, ref } from 'vue';\nimport { freshDate, parseDate, parseTime, formatTime, formatDate, getStandardTimezone } from '@/core/util/helper/datefns';\nimport { navigate } from '@/core/util/helper/navigation';\nimport useLocale from '@/core/util/composable/useLocale';\nimport { APIService } from '@/core/util/services/api.service';\nimport usePaginate from '@ohrm/core/util/composable/usePaginate';\nimport useDateFormat from '@/core/util/composable/useDateFormat';\nimport { required, validDateFormat } from '@/core/util/validation/rules';\nimport RecordCell from '@/orangehrmAttendancePlugin/components/RecordCell.vue';\nimport DeleteConfirmationDialog from '@ohrm/components/dialogs/DeleteConfirmationDialog';\nexport default {\n  components: {\n    'delete-confirmation': DeleteConfirmationDialog\n  },\n  props: {\n    date: {\n      type: String,\n      default: null\n    },\n    isEditable: {\n      type: Boolean,\n      default: false\n    }\n  },\n  setup(props) {\n    const {\n      locale\n    } = useLocale();\n    const {\n      jsDateFormat,\n      userDateFormat,\n      timeFormat,\n      jsTimeFormat\n    } = useDateFormat();\n    const rules = {\n      date: [required, validDateFormat(userDateFormat)]\n    };\n    const filters = ref({\n      date: props.date ? props.date : formatDate(freshDate(), 'yyyy-MM-dd')\n    });\n    const serializedFilters = computed(() => {\n      return {\n        date: filters.value.date\n      };\n    });\n    const http = new APIService(window.appGlobal.baseUrl, '/api/v2/attendance/records');\n    const attendanceRecordNormalizer = data => {\n      return data.map(item => {\n        const {\n          punchIn,\n          punchOut\n        } = item;\n        const punchInDate = formatDate(parseDate(punchIn?.userDate), jsDateFormat, {\n          locale\n        });\n        const punchInTime = formatTime(parseTime(punchIn?.userTime, timeFormat), jsTimeFormat);\n        const punchOutDate = formatDate(parseDate(punchOut?.userDate), jsDateFormat, {\n          locale\n        });\n        const punchOutTime = formatTime(parseTime(punchOut?.userTime, timeFormat), jsTimeFormat);\n        return {\n          id: item.id,\n          punchIn: {\n            ...punchIn,\n            userTime: punchInTime,\n            userDate: punchInDate\n          },\n          punchOut: {\n            ...punchOut,\n            userTime: punchOutTime,\n            userDate: punchOutDate\n          },\n          punchInNote: punchIn.note,\n          punchOutNote: punchOut.note,\n          duration: item.duration\n        };\n      });\n    };\n    const {\n      total,\n      pages,\n      pageSize,\n      response,\n      isLoading,\n      execQuery,\n      currentPage,\n      showPaginator\n    } = usePaginate(http, {\n      query: serializedFilters,\n      normalizer: attendanceRecordNormalizer\n    });\n    const totalDuration = computed(() => {\n      const meta = response.value?.meta;\n      return meta ? meta.sum.label : '0.00';\n    });\n    return {\n      http,\n      rules,\n      total,\n      pages,\n      filters,\n      pageSize,\n      isLoading,\n      execQuery,\n      currentPage,\n      showPaginator,\n      items: response,\n      totalDuration\n    };\n  },\n  data() {\n    return {\n      headers: [{\n        name: 'punchIn',\n        slot: 'title',\n        title: this.$t('attendance.punch_in'),\n        style: {\n          flex: 1\n        },\n        cellRenderer: this.cellRenderer\n      }, {\n        name: 'punchInNote',\n        slot: 'title',\n        cellType: 'oxd-table-cell-truncate',\n        title: this.$t('attendance.punch_in_note'),\n        style: {\n          flex: 1\n        }\n      }, {\n        name: 'punchOut',\n        slot: 'title',\n        title: this.$t('attendance.punch_out'),\n        style: {\n          flex: 1\n        },\n        cellRenderer: this.cellRenderer\n      }, {\n        name: 'punchOutNote',\n        slot: 'title',\n        cellType: 'oxd-table-cell-truncate',\n        title: this.$t('attendance.punch_out_note'),\n        style: {\n          flex: 1\n        }\n      }, {\n        name: 'duration',\n        slot: 'title',\n        title: this.$t('attendance.duration_hours'),\n        style: {\n          flex: 1\n        }\n      }, {\n        ...(this.isEditable && {\n          name: 'actions',\n          slot: 'action',\n          title: this.$t('general.actions'),\n          style: {\n            flex: 1\n          },\n          cellType: 'oxd-table-cell-actions',\n          cellConfig: {\n            delete: {\n              onClick: this.onClickDelete,\n              component: 'oxd-icon-button',\n              props: {\n                name: 'trash'\n              }\n            },\n            edit: {\n              onClick: this.onClickEdit,\n              props: {\n                name: 'pencil-fill'\n              }\n            }\n          }\n        })\n      }],\n      checkedItems: []\n    };\n  },\n  methods: {\n    cellRenderer(...args) {\n      const cellData = args[1];\n      return {\n        component: RecordCell,\n        props: {\n          date: cellData.userDate,\n          time: cellData.userTime,\n          offset: getStandardTimezone(cellData.offset)\n        }\n      };\n    },\n    onClickEdit(item) {\n      navigate('/attendance/editAttendanceRecord/{id}', {\n        id: item.id\n      });\n    },\n    onClickDeleteSelected() {\n      const ids = this.checkedItems.map(index => {\n        return this.items?.data[index].id;\n      });\n      this.$refs.deleteDialog.showDialog().then(confirmation => {\n        if (confirmation === 'ok') {\n          this.deleteItems(ids);\n        }\n      });\n    },\n    onClickDelete(item) {\n      this.$refs.deleteDialog.showDialog().then(confirmation => {\n        if (confirmation === 'ok') {\n          this.deleteItems([item.id]);\n        }\n      });\n    },\n    deleteItems(items) {\n      if (items instanceof Array) {\n        this.isLoading = true;\n        this.http.deleteAll({\n          ids: items\n        }).then(() => {\n          return this.$toast.deleteSuccess();\n        }).then(() => {\n          this.isLoading = false;\n          this.resetDataTable();\n        });\n      }\n    },\n    async resetDataTable() {\n      this.checkedItems = [];\n      await this.execQuery();\n    },\n    async filterItems() {\n      await this.execQuery();\n    }\n  }\n};","map":{"version":3,"mappings":"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","names":["computed","ref","freshDate","parseDate","parseTime","formatTime","formatDate","getStandardTimezone","navigate","useLocale","APIService","usePaginate","useDateFormat","required","validDateFormat","RecordCell","DeleteConfirmationDialog","components","props","date","type","String","default","isEditable","Boolean","setup","locale","jsDateFormat","userDateFormat","timeFormat","jsTimeFormat","rules","filters","serializedFilters","value","http","window","appGlobal","baseUrl","attendanceRecordNormalizer","data","map","item","punchIn","punchOut","punchInDate","userDate","punchInTime","userTime","punchOutDate","punchOutTime","id","punchInNote","note","punchOutNote","duration","total","pages","pageSize","response","isLoading","execQuery","currentPage","showPaginator","query","normalizer","totalDuration","meta","sum","label","items","headers","name","slot","title","$t","style","flex","cellRenderer","cellType","cellConfig","delete","onClick","onClickDelete","component","edit","onClickEdit","checkedItems","methods","args","cellData","time","offset","onClickDeleteSelected","ids","index","$refs","deleteDialog","showDialog","then","confirmation","deleteItems","Array","deleteAll","$toast","deleteSuccess","resetDataTable","filterItems"],"sourceRoot":"","sources":["C:\\xampp\\htdocs\\orangehrm-5.7\\src\\client\\src\\orangehrmAttendancePlugin\\pages\\ViewMyAttendance.vue"],"sourcesContent":["<!--\n/**\n * OrangeHRM is a comprehensive Human Resource Management (HRM) System that captures\n * all the essential functionalities required for any enterprise.\n * Copyright (C) 2006 OrangeHRM Inc., http://www.orangehrm.com\n *\n * OrangeHRM is free software: you can redistribute it and/or modify it under the terms of\n * the GNU General Public License as published by the Free Software Foundation, either\n * version 3 of the License, or (at your option) any later version.\n *\n * OrangeHRM is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;\n * without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n * See the GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License along with OrangeHRM.\n * If not, see <https://www.gnu.org/licenses/>.\n */\n -->\n\n<template>\n  <oxd-table-filter :filter-title=\"$t('attendance.my_attendance_records')\">\n    <oxd-form @submit-valid=\"filterItems\">\n      <oxd-form-row>\n        <oxd-grid :cols=\"4\" class=\"orangehrm-full-width-grid\">\n          <oxd-grid-item>\n            <date-input\n              v-model=\"filters.date\"\n              :rules=\"rules.date\"\n              :label=\"$t('general.date')\"\n              required\n            />\n          </oxd-grid-item>\n        </oxd-grid>\n      </oxd-form-row>\n\n      <oxd-divider />\n\n      <oxd-form-actions>\n        <required-text />\n        <oxd-button\n          display-type=\"secondary\"\n          :label=\"$t('general.view')\"\n          type=\"submit\"\n        />\n      </oxd-form-actions>\n    </oxd-form>\n  </oxd-table-filter>\n  <br />\n  <div class=\"orangehrm-paper-container\">\n    <div class=\"orangehrm-header-container\">\n      <oxd-text class=\"orangehrm-header-total\" tag=\"span\">\n        {{ $t('time.total_duration') }}: {{ totalDuration }}\n      </oxd-text>\n    </div>\n    <table-header\n      :total=\"total\"\n      :loading=\"isLoading\"\n      :selected=\"checkedItems.length\"\n      @delete=\"onClickDeleteSelected\"\n    ></table-header>\n    <div class=\"orangehrm-container\">\n      <oxd-card-table\n        v-model:selected=\"checkedItems\"\n        :headers=\"headers\"\n        :items=\"items?.data\"\n        :selectable=\"isEditable\"\n        :clickable=\"false\"\n        :loading=\"isLoading\"\n        class=\"orangehrm-my-attendance\"\n        row-decorator=\"oxd-table-decorator-card\"\n      />\n    </div>\n    <div class=\"orangehrm-bottom-container\">\n      <oxd-pagination\n        v-if=\"showPaginator\"\n        v-model:current=\"currentPage\"\n        :length=\"pages\"\n      />\n    </div>\n    <delete-confirmation ref=\"deleteDialog\"></delete-confirmation>\n  </div>\n</template>\n\n<script>\nimport {computed, ref} from 'vue';\nimport {\n  freshDate,\n  parseDate,\n  parseTime,\n  formatTime,\n  formatDate,\n  getStandardTimezone,\n} from '@/core/util/helper/datefns';\nimport {navigate} from '@/core/util/helper/navigation';\nimport useLocale from '@/core/util/composable/useLocale';\nimport {APIService} from '@/core/util/services/api.service';\nimport usePaginate from '@ohrm/core/util/composable/usePaginate';\nimport useDateFormat from '@/core/util/composable/useDateFormat';\nimport {required, validDateFormat} from '@/core/util/validation/rules';\nimport RecordCell from '@/orangehrmAttendancePlugin/components/RecordCell.vue';\nimport DeleteConfirmationDialog from '@ohrm/components/dialogs/DeleteConfirmationDialog';\n\nexport default {\n  components: {\n    'delete-confirmation': DeleteConfirmationDialog,\n  },\n\n  props: {\n    date: {\n      type: String,\n      default: null,\n    },\n    isEditable: {\n      type: Boolean,\n      default: false,\n    },\n  },\n\n  setup(props) {\n    const {locale} = useLocale();\n    const {jsDateFormat, userDateFormat, timeFormat, jsTimeFormat} =\n      useDateFormat();\n\n    const rules = {\n      date: [required, validDateFormat(userDateFormat)],\n    };\n    const filters = ref({\n      date: props.date ? props.date : formatDate(freshDate(), 'yyyy-MM-dd'),\n    });\n\n    const serializedFilters = computed(() => {\n      return {\n        date: filters.value.date,\n      };\n    });\n\n    const http = new APIService(\n      window.appGlobal.baseUrl,\n      '/api/v2/attendance/records',\n    );\n\n    const attendanceRecordNormalizer = (data) => {\n      return data.map((item) => {\n        const {punchIn, punchOut} = item;\n        const punchInDate = formatDate(\n          parseDate(punchIn?.userDate),\n          jsDateFormat,\n          {locale},\n        );\n        const punchInTime = formatTime(\n          parseTime(punchIn?.userTime, timeFormat),\n          jsTimeFormat,\n        );\n        const punchOutDate = formatDate(\n          parseDate(punchOut?.userDate),\n          jsDateFormat,\n          {locale},\n        );\n        const punchOutTime = formatTime(\n          parseTime(punchOut?.userTime, timeFormat),\n          jsTimeFormat,\n        );\n\n        return {\n          id: item.id,\n          punchIn: {\n            ...punchIn,\n            userTime: punchInTime,\n            userDate: punchInDate,\n          },\n          punchOut: {\n            ...punchOut,\n            userTime: punchOutTime,\n            userDate: punchOutDate,\n          },\n          punchInNote: punchIn.note,\n          punchOutNote: punchOut.note,\n          duration: item.duration,\n        };\n      });\n    };\n\n    const {\n      total,\n      pages,\n      pageSize,\n      response,\n      isLoading,\n      execQuery,\n      currentPage,\n      showPaginator,\n    } = usePaginate(http, {\n      query: serializedFilters,\n      normalizer: attendanceRecordNormalizer,\n    });\n\n    const totalDuration = computed(() => {\n      const meta = response.value?.meta;\n      return meta ? meta.sum.label : '0.00';\n    });\n\n    return {\n      http,\n      rules,\n      total,\n      pages,\n      filters,\n      pageSize,\n      isLoading,\n      execQuery,\n      currentPage,\n      showPaginator,\n      items: response,\n      totalDuration,\n    };\n  },\n\n  data() {\n    return {\n      headers: [\n        {\n          name: 'punchIn',\n          slot: 'title',\n          title: this.$t('attendance.punch_in'),\n          style: {flex: 1},\n          cellRenderer: this.cellRenderer,\n        },\n        {\n          name: 'punchInNote',\n          slot: 'title',\n          cellType: 'oxd-table-cell-truncate',\n          title: this.$t('attendance.punch_in_note'),\n          style: {flex: 1},\n        },\n        {\n          name: 'punchOut',\n          slot: 'title',\n          title: this.$t('attendance.punch_out'),\n          style: {flex: 1},\n          cellRenderer: this.cellRenderer,\n        },\n        {\n          name: 'punchOutNote',\n          slot: 'title',\n          cellType: 'oxd-table-cell-truncate',\n          title: this.$t('attendance.punch_out_note'),\n          style: {flex: 1},\n        },\n        {\n          name: 'duration',\n          slot: 'title',\n          title: this.$t('attendance.duration_hours'),\n          style: {flex: 1},\n        },\n        {\n          ...(this.isEditable && {\n            name: 'actions',\n            slot: 'action',\n            title: this.$t('general.actions'),\n            style: {flex: 1},\n            cellType: 'oxd-table-cell-actions',\n            cellConfig: {\n              delete: {\n                onClick: this.onClickDelete,\n                component: 'oxd-icon-button',\n                props: {\n                  name: 'trash',\n                },\n              },\n              edit: {\n                onClick: this.onClickEdit,\n                props: {\n                  name: 'pencil-fill',\n                },\n              },\n            },\n          }),\n        },\n      ],\n      checkedItems: [],\n    };\n  },\n\n  methods: {\n    cellRenderer(...args) {\n      const cellData = args[1];\n      return {\n        component: RecordCell,\n        props: {\n          date: cellData.userDate,\n          time: cellData.userTime,\n          offset: getStandardTimezone(cellData.offset),\n        },\n      };\n    },\n    onClickEdit(item) {\n      navigate('/attendance/editAttendanceRecord/{id}', {id: item.id});\n    },\n    onClickDeleteSelected() {\n      const ids = this.checkedItems.map((index) => {\n        return this.items?.data[index].id;\n      });\n      this.$refs.deleteDialog.showDialog().then((confirmation) => {\n        if (confirmation === 'ok') {\n          this.deleteItems(ids);\n        }\n      });\n    },\n    onClickDelete(item) {\n      this.$refs.deleteDialog.showDialog().then((confirmation) => {\n        if (confirmation === 'ok') {\n          this.deleteItems([item.id]);\n        }\n      });\n    },\n    deleteItems(items) {\n      if (items instanceof Array) {\n        this.isLoading = true;\n        this.http\n          .deleteAll({\n            ids: items,\n          })\n          .then(() => {\n            return this.$toast.deleteSuccess();\n          })\n          .then(() => {\n            this.isLoading = false;\n            this.resetDataTable();\n          });\n      }\n    },\n    async resetDataTable() {\n      this.checkedItems = [];\n      await this.execQuery();\n    },\n    async filterItems() {\n      await this.execQuery();\n    },\n  },\n};\n</script>\n\n<style src=\"./view-my-attendance.scss\" lang=\"scss\" scoped></style>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}