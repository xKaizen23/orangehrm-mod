{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, withCtx as _withCtx, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-61e4b631\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"orangehrm-background-container\"\n};\nconst _hoisted_2 = {\n  class: \"orangehrm-paper-container\"\n};\nconst _hoisted_3 = {\n  class: \"orangehrm-header-container\"\n};\nconst _hoisted_4 = {\n  class: \"orangehrm-bottom-container\"\n};\nconst _hoisted_5 = {\n  key: 0,\n  class: \"loading-spinner\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_oxd_alert = _resolveComponent(\"oxd-alert\");\n  const _component_oxd_text = _resolveComponent(\"oxd-text\");\n  const _component_oxd_pagination = _resolveComponent(\"oxd-pagination\");\n  const _component_table_header = _resolveComponent(\"table-header\");\n  const _component_edit_translations = _resolveComponent(\"edit-translations\");\n  const _component_oxd_button = _resolveComponent(\"oxd-button\");\n  const _component_oxd_form_actions = _resolveComponent(\"oxd-form-actions\");\n  const _component_oxd_form = _resolveComponent(\"oxd-form\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createVNode(_component_oxd_alert, {\n    show: !$setup.isLoading && $setup.showPaginator && $setup.itemsModified,\n    type: \"info\",\n    message: _ctx.$t('admin.please_save_before_pagination')\n  }, null, 8, [\"show\", \"message\"]), _createElementVNode(\"div\", _hoisted_2, [$setup.total > 0 ? (_openBlock(), _createBlock(_component_oxd_form, {\n    key: 0,\n    loading: $setup.isLoading,\n    onSubmitValid: $setup.onSubmitLangString,\n    onReset: $setup.onReset\n  }, {\n    default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_3, [_createVNode(_component_oxd_text, {\n      tag: \"h6\",\n      class: \"orangehrm-main-title\"\n    }, {\n      default: _withCtx(() => [_createTextVNode(_toDisplayString(_ctx.$t('admin.errors_in_import_language_packages')), 1)]),\n      _: 1\n    }), $setup.showPaginator && !$setup.itemsModified ? (_openBlock(), _createBlock(_component_oxd_pagination, {\n      key: $setup.currentPage,\n      current: $setup.currentPage,\n      \"onUpdate:current\": _cache[0] || (_cache[0] = $event => $setup.currentPage = $event),\n      length: $setup.pages\n    }, null, 8, [\"current\", \"length\"])) : _createCommentVNode(\"\", true)]), _createVNode(_component_table_header, {\n      loading: $setup.isLoading,\n      total: $setup.total,\n      selected: 0,\n      \"records-found-lang-string\": \"admin.n_errors_found\"\n    }, null, 8, [\"loading\", \"total\"]), $setup.items?.data ? (_openBlock(), _createBlock(_component_edit_translations, {\n      key: 0,\n      langstrings: $setup.items.data,\n      \"onUpdate:langstrings\": [_cache[1] || (_cache[1] = $event => $setup.items.data = $event), $setup.checkItemsModified]\n    }, null, 8, [\"langstrings\", \"onUpdate:langstrings\"])) : _createCommentVNode(\"\", true), _createVNode(_component_oxd_form_actions, null, {\n      default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_4, [_createElementVNode(\"div\", null, [_createVNode(_component_oxd_button, {\n        \"display-type\": \"ghost\",\n        label: _ctx.$t('general.reset'),\n        type: \"reset\"\n      }, null, 8, [\"label\"]), _createVNode(_component_oxd_button, {\n        class: \"orangehrm-left-space\",\n        \"display-type\": \"secondary\",\n        label: _ctx.$t('general.save'),\n        type: \"submit\",\n        disabled: $setup.isLoading\n      }, null, 8, [\"label\", \"disabled\"]), $setup.isLoading ? (_openBlock(), _createElementBlock(\"span\", _hoisted_5)) : _createCommentVNode(\"\", true)])])]),\n      _: 1\n    })]),\n    _: 1\n  }, 8, [\"loading\", \"onSubmitValid\", \"onReset\"])) : _createCommentVNode(\"\", true)])]);\n}","map":{"version":3,"mappings":";;;EAoBOA,KAAK,EAAC;AAAgC;;EAMpCA,KAAK,EAAC;AAA2B;;EAO7BA,KAAK,EAAC;AAA4B;;EAuBhCA,KAAK,EAAC;AAA4B;;;EAcZA,KAAK,EAAC;;;;;;;;;;;uBAlDzCC,oBAwDM,OAxDNC,UAwDM,GAvDJC,aAIaC;IAHVC,IAAI,GAAGC,gBAAS,IAAIA,oBAAa,IAAIA,oBAAa;IACnDC,IAAI,EAAC,MAAM;IACVC,OAAO,EAAEC,OAAE;oCAEdC,oBAiDM,OAjDNC,UAiDM,GA/CIL,YAAK,sBADbM,aA+CWC;;IA7CRC,OAAO,EAAER,gBAAS;IAClBS,aAAY,EAAET,yBAAkB;IAChCU,OAAK,EAAEV;;sBAER,MAUM,CAVNI,oBAUM,OAVNO,UAUM,GATJd,aAEWe;MAFDC,GAAG,EAAC,IAAI;MAACnB,KAAK,EAAC;;wBACvB,MAAoD,mCAAjDS,OAAE;;QAGCH,oBAAa,KAAKA,oBAAa,kBADvCM,aAKEQ;MAHCC,GAAG,EAAEf,kBAAW;MACTgB,OAAO,EAAEhB,kBAAW;8DAAXA,kBAAW;MAC3BiB,MAAM,EAAEjB;2EAGbH,aAKgBqB;MAJbV,OAAO,EAAER,gBAAS;MAClBmB,KAAK,EAAEnB,YAAK;MACZoB,QAAQ,EAAE,CAAC;MACZ,2BAAyB,EAAC;uCAGpBpB,YAAK,EAAEqB,IAAI,kBADnBf,aAIqBgB;;MAFXC,WAAW,EAAEvB,YAAK,CAACqB,IAAI;mEAAVrB,YAAK,CAACqB,IAAI,YACVrB,yBAAkB;2FAEzCH,aAkBmB2B;wBAjBjB,MAgBM,CAhBNpB,oBAgBM,OAhBNqB,UAgBM,GAfJrB,oBAcM,cAbJP,aAIE6B;QAHA,cAAY,EAAC,OAAO;QACnBC,KAAK,EAAExB,OAAE;QACVF,IAAI,EAAC;8BAEPJ,aAME6B;QALAhC,KAAK,EAAC,sBAAsB;QAC5B,cAAY,EAAC,WAAW;QACvBiC,KAAK,EAAExB,OAAE;QACVF,IAAI,EAAC,QAAQ;QACZ2B,QAAQ,EAAE5B;0CAEDA,gBAAS,kBAArBL,oBAAsD,QAAtDkC,UAAsD","names":["class","_createElementBlock","_hoisted_1","_createVNode","_component_oxd_alert","show","$setup","type","message","_ctx","_createElementVNode","_hoisted_2","_createBlock","_component_oxd_form","loading","onSubmitValid","onReset","_hoisted_3","_component_oxd_text","tag","_component_oxd_pagination","key","current","length","_component_table_header","total","selected","data","_component_edit_translations","langstrings","_component_oxd_form_actions","_hoisted_4","_component_oxd_button","label","disabled","_hoisted_5"],"sourceRoot":"","sources":["C:\\xampp\\htdocs\\orangehrm-5.7\\src\\client\\src\\orangehrmAdminPlugin\\pages\\languageImport\\FixLanguageStringErrors.vue"],"sourcesContent":["<!--\n/**\n * OrangeHRM is a comprehensive Human Resource Management (HRM) System that captures\n * all the essential functionalities required for any enterprise.\n * Copyright (C) 2006 OrangeHRM Inc., http://www.orangehrm.com\n *\n * OrangeHRM is free software: you can redistribute it and/or modify it under the terms of\n * the GNU General Public License as published by the Free Software Foundation, either\n * version 3 of the License, or (at your option) any later version.\n *\n * OrangeHRM is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;\n * without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n * See the GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License along with OrangeHRM.\n * If not, see <https://www.gnu.org/licenses/>.\n */\n -->\n\n<template>\n  <div class=\"orangehrm-background-container\">\n    <oxd-alert\n      :show=\"!isLoading && showPaginator && itemsModified\"\n      type=\"info\"\n      :message=\"$t('admin.please_save_before_pagination')\"\n    ></oxd-alert>\n    <div class=\"orangehrm-paper-container\">\n      <oxd-form\n        v-if=\"total > 0\"\n        :loading=\"isLoading\"\n        @submit-valid=\"onSubmitLangString\"\n        @reset=\"onReset\"\n      >\n        <div class=\"orangehrm-header-container\">\n          <oxd-text tag=\"h6\" class=\"orangehrm-main-title\">\n            {{ $t('admin.errors_in_import_language_packages') }}\n          </oxd-text>\n          <oxd-pagination\n            v-if=\"showPaginator && !itemsModified\"\n            :key=\"currentPage\"\n            v-model:current=\"currentPage\"\n            :length=\"pages\"\n          />\n        </div>\n        <table-header\n          :loading=\"isLoading\"\n          :total=\"total\"\n          :selected=\"0\"\n          records-found-lang-string=\"admin.n_errors_found\"\n        ></table-header>\n        <edit-translations\n          v-if=\"items?.data\"\n          v-model:langstrings=\"items.data\"\n          @update:langstrings=\"checkItemsModified\"\n        ></edit-translations>\n        <oxd-form-actions>\n          <div class=\"orangehrm-bottom-container\">\n            <div>\n              <oxd-button\n                display-type=\"ghost\"\n                :label=\"$t('general.reset')\"\n                type=\"reset\"\n              />\n              <oxd-button\n                class=\"orangehrm-left-space\"\n                display-type=\"secondary\"\n                :label=\"$t('general.save')\"\n                type=\"submit\"\n                :disabled=\"isLoading\"\n              />\n              <span v-if=\"isLoading\" class=\"loading-spinner\"></span>\n            </div>\n          </div>\n        </oxd-form-actions>\n      </oxd-form>\n    </div>\n  </div>\n</template>\n\n<script>\nimport useToast from '@/core/util/composable/useToast';\nimport {APIService} from '@/core/util/services/api.service';\nimport FixLanguageStringErrorTable from '@/orangehrmAdminPlugin/components/FixLanguageStringErrorTable.vue';\nimport usePaginate from '@/core/util/composable/usePaginate';\nimport {navigate} from '@/core/util/helper/navigation';\nimport {ref} from 'vue';\nimport {OxdAlert} from '@ohrm/oxd';\n\nexport default {\n  name: 'FixLanguageStringErrors',\n  components: {\n    'oxd-alert': OxdAlert,\n    'edit-translations': FixLanguageStringErrorTable,\n  },\n  props: {\n    languageId: {\n      type: Number,\n      required: true,\n    },\n    empNumber: {\n      type: Number,\n      required: true,\n    },\n    languagePackage: {\n      type: String,\n      required: true,\n    },\n    sourceLanguage: {\n      type: String,\n      required: true,\n    },\n  },\n\n  setup(props) {\n    const {saveSuccess} = useToast();\n\n    const http = new APIService(\n      window.appGlobal.baseUrl,\n      `/api/v2/admin/i18n/languages/${props.languageId}/translations/errors`,\n    );\n\n    const {\n      showPaginator,\n      currentPage,\n      total,\n      pages,\n      response: items,\n      isLoading,\n      execQuery,\n    } = usePaginate(http);\n\n    const itemsModified = ref(false);\n\n    const onReset = () => {\n      currentPage.value = 1;\n      itemsModified.value = false;\n      execQuery();\n    };\n\n    const checkItemsModified = () => {\n      itemsModified.value = items.value.data.reduce(\n        (accumulator, item) =>\n          accumulator || (item.target !== '' && item.modified === true),\n        false,\n      );\n    };\n\n    const onSubmitLangString = () => {\n      isLoading.value = true;\n      http\n        .request({\n          method: `PUT`,\n          url: `/api/v2/admin/i18n/languages/${props.languageId}/translations/bulk`,\n          data: {\n            data: items.value.data\n              .filter((item) => item.target !== null && item.modified === true)\n              .map((item) => {\n                return {\n                  langStringId: item.langStringId,\n                  translatedValue: item.target,\n                };\n              }),\n          },\n        })\n        .then(() => {\n          return saveSuccess();\n        })\n        .then(() => {\n          currentPage.value = 1;\n          itemsModified.value = false;\n          execQuery();\n        });\n    };\n\n    return {\n      showPaginator,\n      currentPage,\n      isLoading,\n      total,\n      pages,\n      items,\n      onReset,\n      onSubmitLangString,\n      itemsModified,\n      checkItemsModified,\n    };\n  },\n\n  watch: {\n    total(value) {\n      if (value === 0) {\n        navigate('/admin/languagePackage');\n      }\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.orangehrm-header-container {\n  display: flex;\n  align-items: center;\n}\n\n.orangehrm-main-title {\n  text-align: left;\n}\n\n.pagination {\n  margin-left: auto;\n}\n</style>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}